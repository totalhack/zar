import csv
import math

import pgeocode
from tlbx import info, warn, error

from app.core.config import settings

nomi = pgeocode.Nominatim("us")

AREA_CODES = {
    "201": {
        "Metro Area": "Jersey City, NJ",
        "Latitude": "40.73",
        "Longitude": "-74.08",
        "Population": 1700000,
    },
    "202": {
        "Metro Area": "Washington, DC",
        "Latitude": "38.90",
        "Longitude": "-77.04",
        "Population": 700000,
    },
    "203": {
        "Metro Area": "Bridgeport, CT",
        "Latitude": "41.18",
        "Longitude": "-73.19",
        "Population": 1400000,
    },
    "205": {
        "Metro Area": "Birmingham, AL",
        "Latitude": "33.52",
        "Longitude": "-86.8",
        "Population": 1100000,
    },
    "206": {
        "Metro Area": "Seattle, WA",
        "Latitude": "47.61",
        "Longitude": "-122.33",
        "Population": 2200000,
    },
    "207": {
        "Metro Area": "Portland, ME",
        "Latitude": "43.66",
        "Longitude": "-70.25",
        "Population": 1360000,
    },
    "208": {
        "Metro Area": "Boise, ID",
        "Latitude": "43.61",
        "Longitude": "-116.2",
        "Population": 975000,
    },
    "209": {
        "Metro Area": "Stockton, CA",
        "Latitude": "37.96",
        "Longitude": "-121.29",
        "Population": 1700000,
    },
    "210": {
        "Metro Area": "San Antonio, TX",
        "Latitude": "29.42",
        "Longitude": "-98.49",
        "Population": 2600000,
    },
    "212": {
        "Metro Area": "New York, NY",
        "Latitude": "40.71",
        "Longitude": "-74.01",
        "Population": 1650000,
    },
    "213": {
        "Metro Area": "Los Angeles, CA",
        "Latitude": "34.05",
        "Longitude": "-118.24",
        "Population": 2000000,
    },
    "214": {
        "Metro Area": "Dallas, TX",
        "Latitude": "32.78",
        "Longitude": "-96.8",
        "Population": 2600000,
    },
    "215": {
        "Metro Area": "Philadelphia, PA",
        "Latitude": "39.95",
        "Longitude": "-75.16",
        "Population": 2150000,
    },
    "216": {
        "Metro Area": "Cleveland, OH",
        "Latitude": "41.50",
        "Longitude": "-81.69",
        "Population": 1250000,
    },
    "217": {
        "Metro Area": "Springfield, IL",
        "Latitude": "39.80",
        "Longitude": "-89.64",
        "Population": 700000,
    },
    "218": {
        "Metro Area": "Duluth, MN",
        "Latitude": "46.78",
        "Longitude": "-92.1",
        "Population": 650000,
    },
    "219": {
        "Metro Area": "Hammond, IN",
        "Latitude": "41.61",
        "Longitude": "-87.5",
        "Population": 750000,
    },
    "220": {
        "Metro Area": "Newark, OH",
        "Latitude": "40.06",
        "Longitude": "-82.4",
        "Population": 600000,
    },
    "223": {
        "Metro Area": "Lancaster, PA",
        "Latitude": "40.04",
        "Longitude": "-76.31",
        "Population": 1200000,
    },
    "224": {
        "Metro Area": "Elgin, IL",
        "Latitude": "42.04",
        "Longitude": "-88.28",
        "Population": 1800000,
    },
    "225": {
        "Metro Area": "Baton Rouge, LA",
        "Latitude": "30.45",
        "Longitude": "-91.19",
        "Population": 850000,
    },
    "227": {
        "Metro Area": "Germantown, MD",
        "Latitude": "39.17",
        "Longitude": "-77.27",
        "Population": 1000000,
    },
    "228": {
        "Metro Area": "Gulfport, MS",
        "Latitude": "30.37",
        "Longitude": "-89.09",
        "Population": 400000,
    },
    "229": {
        "Metro Area": "Albany, GA",
        "Latitude": "31.58",
        "Longitude": "-84.16",
        "Population": 400000,
    },
    "231": {
        "Metro Area": "Muskegon, MI",
        "Latitude": "43.23",
        "Longitude": "-86.25",
        "Population": 500000,
    },
    "234": {
        "Metro Area": "Akron, OH",
        "Latitude": "41.08",
        "Longitude": "-81.52",
        "Population": 700000,
    },
    "235": {
        "Metro Area": "Columbia, MO",
        "Latitude": "38.95",
        "Longitude": "-92.33",
        "Population": 420000,
    },
    "239": {
        "Metro Area": "Cape Coral, FL",
        "Latitude": "26.66",
        "Longitude": "-81.95",
        "Population": 800000,
    },
    "240": {
        "Metro Area": "Germantown, MD",
        "Latitude": "39.17",
        "Longitude": "-77.27",
        "Population": 1000000,
    },
    "248": {
        "Metro Area": "Troy, MI",
        "Latitude": "42.61",
        "Longitude": "-83.15",
        "Population": 1200000,
    },
    "251": {
        "Metro Area": "Mobile, AL",
        "Latitude": "30.69",
        "Longitude": "-88.04",
        "Population": 600000,
    },
    "252": {
        "Metro Area": "Greenville, NC",
        "Latitude": "35.61",
        "Longitude": "-77.37",
        "Population": 900000,
    },
    "253": {
        "Metro Area": "Tacoma, WA",
        "Latitude": "47.25",
        "Longitude": "-122.44",
        "Population": 1000000,
    },
    "254": {
        "Metro Area": "Killeen, TX",
        "Latitude": "31.12",
        "Longitude": "-97.73",
        "Population": 650000,
    },
    "256": {
        "Metro Area": "Huntsville, AL",
        "Latitude": "34.73",
        "Longitude": "-86.59",
        "Population": 1000000,
    },
    "260": {
        "Metro Area": "Fort Wayne, IN",
        "Latitude": "41.08",
        "Longitude": "-85.14",
        "Population": 650000,
    },
    "262": {
        "Metro Area": "Kenosha, WI",
        "Latitude": "42.58",
        "Longitude": "-87.82",
        "Population": 850000,
    },
    "267": {
        "Metro Area": "Philadelphia, PA",
        "Latitude": "39.95",
        "Longitude": "-75.16",
        "Population": 2150000,
    },
    "269": {
        "Metro Area": "Kalamazoo, MI",
        "Latitude": "42.29",
        "Longitude": "-85.59",
        "Population": 500000,
    },
    "270": {
        "Metro Area": "Bowling Green, KY",
        "Latitude": "36.99",
        "Longitude": "-86.44",
        "Population": 750000,
    },
    "272": {
        "Metro Area": "Scranton, PA",
        "Latitude": "41.41",
        "Longitude": "-75.66",
        "Population": 800000,
    },
    "274": {
        "Metro Area": "Green Bay, WI",
        "Latitude": "44.51",
        "Longitude": "-88.01",
        "Population": 600000,
    },
    "276": {
        "Metro Area": "Bristol, VA",
        "Latitude": "36.60",
        "Longitude": "-82.18",
        "Population": 400000,
    },
    "279": {
        "Metro Area": "Sacramento, CA",
        "Latitude": "38.58",
        "Longitude": "-121.49",
        "Population": 1500000,
    },
    "281": {
        "Metro Area": "Houston, TX",
        "Latitude": "29.76",
        "Longitude": "-95.36",
        "Population": 7100000,
    },
    "283": {
        "Metro Area": "Cincinnati, OH",
        "Latitude": "39.10",
        "Longitude": "-84.51",
        "Population": 1700000,
    },
    "301": {
        "Metro Area": "Germantown, MD",
        "Latitude": "39.17",
        "Longitude": "-77.27",
        "Population": 1000000,
    },
    "302": {
        "Metro Area": "Wilmington, DE",
        "Latitude": "39.74",
        "Longitude": "-75.55",
        "Population": 1000000,
    },
    "303": {
        "Metro Area": "Denver, CO",
        "Latitude": "39.74",
        "Longitude": "-104.99",
        "Population": 2900000,
    },
    "304": {
        "Metro Area": "Charleston, WV",
        "Latitude": "38.35",
        "Longitude": "-81.63",
        "Population": 1770000,
    },
    "305": {
        "Metro Area": "Miami, FL",
        "Latitude": "25.76",
        "Longitude": "-80.19",
        "Population": 2700000,
    },
    "307": {
        "Metro Area": "Cheyenne, WY",
        "Latitude": "41.14",
        "Longitude": "-104.82",
        "Population": 580000,
    },
    "308": {
        "Metro Area": "Grand Island, NE",
        "Latitude": "40.92",
        "Longitude": "-98.34",
        "Population": 450000,
    },
    "309": {
        "Metro Area": "Peoria, IL",
        "Latitude": "40.69",
        "Longitude": "-89.59",
        "Population": 600000,
    },
    "310": {
        "Metro Area": "Los Angeles, CA",
        "Latitude": "34.05",
        "Longitude": "-118.24",
        "Population": 3000000,
    },
    "312": {
        "Metro Area": "Chicago, IL",
        "Latitude": "41.88",
        "Longitude": "-87.63",
        "Population": 2750000,
    },
    "313": {
        "Metro Area": "Detroit, MI",
        "Latitude": "42.33",
        "Longitude": "-83.05",
        "Population": 1500000,
    },
    "314": {
        "Metro Area": "St. Louis, MO",
        "Latitude": "38.63",
        "Longitude": "-90.2",
        "Population": 1300000,
    },
    "315": {
        "Metro Area": "Syracuse, NY",
        "Latitude": "43.05",
        "Longitude": "-76.15",
        "Population": 1200000,
    },
    "316": {
        "Metro Area": "Wichita, KS",
        "Latitude": "37.69",
        "Longitude": "-97.34",
        "Population": 700000,
    },
    "317": {
        "Metro Area": "Indianapolis, IN",
        "Latitude": "39.77",
        "Longitude": "-86.16",
        "Population": 1800000,
    },
    "318": {
        "Metro Area": "Shreveport, LA",
        "Latitude": "32.53",
        "Longitude": "-93.75",
        "Population": 600000,
    },
    "319": {
        "Metro Area": "Cedar Rapids, IA",
        "Latitude": "42.00",
        "Longitude": "-91.67",
        "Population": 500000,
    },
    "320": {
        "Metro Area": "St. Cloud, MN",
        "Latitude": "45.55",
        "Longitude": "-94.16",
        "Population": 550000,
    },
    "321": {
        "Metro Area": "Orlando, FL",
        "Latitude": "28.54",
        "Longitude": "-81.38",
        "Population": 1500000,
    },
    "323": {
        "Metro Area": "Los Angeles, CA",
        "Latitude": "34.05",
        "Longitude": "-118.24",
        "Population": 2000000,
    },
    "324": {
        "Metro Area": "Jacksonville, FL",
        "Latitude": "30.33",
        "Longitude": "-81.66",
        "Population": 1000000,
    },
    "325": {
        "Metro Area": "Abilene, TX",
        "Latitude": "32.45",
        "Longitude": "-99.73",
        "Population": 350000,
    },
    "326": {
        "Metro Area": "Dayton, OH",
        "Latitude": "39.76",
        "Longitude": "-84.19",
        "Population": 800000,
    },
    "327": {
        "Metro Area": "Jonesboro, AR",
        "Latitude": "35.84",
        "Longitude": "-90.7",
        "Population": 550000,
    },
    "329": {
        "Metro Area": "New City, NY",
        "Latitude": "41.15",
        "Longitude": "-73.99",
        "Population": 900000,
    },
    "330": {
        "Metro Area": "Akron, OH",
        "Latitude": "41.08",
        "Longitude": "-81.52",
        "Population": 700000,
    },
    "331": {
        "Metro Area": "Aurora, IL",
        "Latitude": "41.76",
        "Longitude": "-88.32",
        "Population": 1500000,
    },
    "332": {
        "Metro Area": "New York, NY",
        "Latitude": "40.71",
        "Longitude": "-74.01",
        "Population": 1650000,
    },
    "334": {
        "Metro Area": "Montgomery, AL",
        "Latitude": "32.38",
        "Longitude": "-86.3",
        "Population": 550000,
    },
    "336": {
        "Metro Area": "Greensboro, NC",
        "Latitude": "36.07",
        "Longitude": "-79.79",
        "Population": 1600000,
    },
    "337": {
        "Metro Area": "Lafayette, LA",
        "Latitude": "30.22",
        "Longitude": "-92.02",
        "Population": 600000,
    },
    "339": {
        "Metro Area": "Boston, MA",
        "Latitude": "42.36",
        "Longitude": "-71.06",
        "Population": 2000000,
    },
    "340": {
        "Metro Area": "Charlotte Amalie, VI",
        "Latitude": "18.34",
        "Longitude": "-64.93",
        "Population": 105000,
    },
    "341": {
        "Metro Area": "Oakland, CA",
        "Latitude": "37.80",
        "Longitude": "-122.27",
        "Population": 1600000,
    },
    "343": {
        "Metro Area": "Ottawa, ON",
        "Latitude": "45.42",
        "Longitude": "-75.7",
        "Population": 1400000,
    },
    "345": {
        "Metro Area": "Cayman Islands",
        "Latitude": "19.31",
        "Longitude": "-81.25",
        "Population": 70000,
    },
    "346": {
        "Metro Area": "Houston, TX",
        "Latitude": "29.76",
        "Longitude": "-95.36",
        "Population": 7100000,
    },
    "347": {
        "Metro Area": "New York, NY",
        "Latitude": "40.71",
        "Longitude": "-74.01",
        "Population": 7000000,
    },
    "350": {
        "Metro Area": "Stockton, CA",
        "Latitude": "37.96",
        "Longitude": "-121.29",
        "Population": 1700000,
    },
    "351": {
        "Metro Area": "Lowell, MA",
        "Latitude": "42.63",
        "Longitude": "-71.32",
        "Population": 1100000,
    },
    "352": {
        "Metro Area": "Gainesville, FL",
        "Latitude": "29.65",
        "Longitude": "-82.32",
        "Population": 1000000,
    },
    "353": {
        "Metro Area": "Madison, WI",
        "Latitude": "43.07",
        "Longitude": "-89.4",
        "Population": 680000,
    },
    "354": {
        "Metro Area": "Granby, QC",
        "Latitude": "45.40",
        "Longitude": "-72.73",
        "Population": 2500000,
    },
    "357": {
        "Metro Area": "Fresno, CA",
        "Latitude": "36.74",
        "Longitude": "-119.77",
        "Population": 1150000,
    },
    "360": {
        "Metro Area": "Vancouver, WA",
        "Latitude": "45.64",
        "Longitude": "-122.66",
        "Population": 1900000,
    },
    "361": {
        "Metro Area": "Corpus Christi, TX",
        "Latitude": "27.80",
        "Longitude": "-97.4",
        "Population": 650000,
    },
    "362": {
        "Metro Area": "Hempstead, NY",
        "Latitude": "40.71",
        "Longitude": "-73.62",
        "Population": 1370000,
    },
    "363": {
        "Metro Area": "Hempstead, NY",
        "Latitude": "40.71",
        "Longitude": "-73.62",
        "Population": 1370000,
    },
    "364": {
        "Metro Area": "Bowling Green, KY",
        "Latitude": "36.99",
        "Longitude": "-86.44",
        "Population": 750000,
    },
    "365": {
        "Metro Area": "Hamilton, ON",
        "Latitude": "43.26",
        "Longitude": "-79.87",
        "Population": 2500000,
    },
    "367": {
        "Metro Area": "Quebec, QC",
        "Latitude": "46.81",
        "Longitude": "-71.21",
        "Population": 850000,
    },
    "368": {
        "Metro Area": "Calgary, AB",
        "Latitude": "51.05",
        "Longitude": "-114.07",
        "Population": 1600000,
    },
    "369": {
        "Metro Area": "Santa Rosa, CA",
        "Latitude": "38.44",
        "Longitude": "-122.71",
        "Population": 650000,
    },
    "380": {
        "Metro Area": "Columbus, OH",
        "Latitude": "39.96",
        "Longitude": "-83.0",
        "Population": 1300000,
    },
    "382": {
        "Metro Area": "London, ON",
        "Latitude": "42.98",
        "Longitude": "-81.24",
        "Population": 550000,
    },
    "385": {
        "Metro Area": "Salt Lake City, UT",
        "Latitude": "40.76",
        "Longitude": "-111.89",
        "Population": 1250000,
    },
    "386": {
        "Metro Area": "Palm Coast, FL",
        "Latitude": "29.54",
        "Longitude": "-81.24",
        "Population": 600000,
    },
    "401": {
        "Metro Area": "Providence, RI",
        "Latitude": "41.82",
        "Longitude": "-71.41",
        "Population": 1100000,
    },
    "402": {
        "Metro Area": "Omaha, NE",
        "Latitude": "41.25",
        "Longitude": "-95.94",
        "Population": 1400000,
    },
    "404": {
        "Metro Area": "Atlanta, GA",
        "Latitude": "33.75",
        "Longitude": "-84.39",
        "Population": 5500000,
    },
    "405": {
        "Metro Area": "Oklahoma City, OK",
        "Latitude": "35.47",
        "Longitude": "-97.52",
        "Population": 1400000,
    },
    "406": {
        "Metro Area": "Billings, MT",
        "Latitude": "45.78",
        "Longitude": "-108.5",
        "Population": 1100000,
    },
    "407": {
        "Metro Area": "Orlando, FL",
        "Latitude": "28.54",
        "Longitude": "-81.38",
        "Population": 2000000,
    },
    "408": {
        "Metro Area": "San Jose, CA",
        "Latitude": "37.34",
        "Longitude": "-121.89",
        "Population": 1800000,
    },
    "409": {
        "Metro Area": "Beaumont, TX",
        "Latitude": "30.08",
        "Longitude": "-94.13",
        "Population": 400000,
    },
    "410": {
        "Metro Area": "Baltimore, MD",
        "Latitude": "39.29",
        "Longitude": "-76.61",
        "Population": 2800000,
    },
    "412": {
        "Metro Area": "Pittsburgh, PA",
        "Latitude": "40.44",
        "Longitude": "-79.99",
        "Population": 1700000,
    },
    "413": {
        "Metro Area": "Springfield, MA",
        "Latitude": "42.10",
        "Longitude": "-72.59",
        "Population": 650000,
    },
    "414": {
        "Metro Area": "Milwaukee, WI",
        "Latitude": "43.04",
        "Longitude": "-87.91",
        "Population": 1400000,
    },
    "415": {
        "Metro Area": "San Francisco, CA",
        "Latitude": "37.77",
        "Longitude": "-122.42",
        "Population": 1600000,
    },
    "416": {
        "Metro Area": "Toronto, ON",
        "Latitude": "43.65",
        "Longitude": "-79.38",
        "Population": 3000000,
    },
    "417": {
        "Metro Area": "Springfield, MO",
        "Latitude": "37.21",
        "Longitude": "-93.3",
        "Population": 650000,
    },
    "419": {
        "Metro Area": "Toledo, OH",
        "Latitude": "41.66",
        "Longitude": "-83.54",
        "Population": 1000000,
    },
    "423": {
        "Metro Area": "Chattanooga, TN",
        "Latitude": "35.05",
        "Longitude": "-85.31",
        "Population": 950000,
    },
    "424": {
        "Metro Area": "Los Angeles, CA",
        "Latitude": "34.05",
        "Longitude": "-118.24",
        "Population": 3000000,
    },
    "425": {
        "Metro Area": "Bellevue, WA",
        "Latitude": "47.61",
        "Longitude": "-122.2",
        "Population": 1400000,
    },
    "430": {
        "Metro Area": "Tyler, TX",
        "Latitude": "32.35",
        "Longitude": "-95.3",
        "Population": 1000000,
    },
    "432": {
        "Metro Area": "Midland, TX",
        "Latitude": "32.00",
        "Longitude": "-102.08",
        "Population": 450000,
    },
    "434": {
        "Metro Area": "Lynchburg, VA",
        "Latitude": "37.41",
        "Longitude": "-79.14",
        "Population": 450000,
    },
    "435": {
        "Metro Area": "St. George, UT",
        "Latitude": "37.10",
        "Longitude": "-113.58",
        "Population": 1000000,
    },
    "436": {
        "Metro Area": "Parma, OH",
        "Latitude": "41.41",
        "Longitude": "-81.73",
        "Population": 1200000,
    },
    "437": {
        "Metro Area": "Toronto, ON",
        "Latitude": "43.65",
        "Longitude": "-79.38",
        "Population": 3000000,
    },
    "440": {
        "Metro Area": "Parma, OH",
        "Latitude": "41.41",
        "Longitude": "-81.73",
        "Population": 1200000,
    },
    "442": {
        "Metro Area": "Oceanside, CA",
        "Latitude": "33.19",
        "Longitude": "-117.38",
        "Population": 1200000,
    },
    "443": {
        "Metro Area": "Baltimore, MD",
        "Latitude": "39.29",
        "Longitude": "-76.61",
        "Population": 2800000,
    },
    "445": {
        "Metro Area": "Philadelphia, PA",
        "Latitude": "39.95",
        "Longitude": "-75.16",
        "Population": 2150000,
    },
    "447": {
        "Metro Area": "Springfield, IL",
        "Latitude": "39.80",
        "Longitude": "-89.64",
        "Population": 700000,
    },
    "448": {
        "Metro Area": "Tallahassee, FL",
        "Latitude": "30.44",
        "Longitude": "-84.28",
        "Population": 1500000,
    },
    "457": {
        "Metro Area": "Shreveport, LA",
        "Latitude": "32.53",
        "Longitude": "-93.75",
        "Population": 600000,
    },
    "458": {
        "Metro Area": "Eugene, OR",
        "Latitude": "44.05",
        "Longitude": "-123.09",
        "Population": 1700000,
    },
    "463": {
        "Metro Area": "Indianapolis, IN",
        "Latitude": "39.77",
        "Longitude": "-86.16",
        "Population": 1800000,
    },
    "464": {
        "Metro Area": "Cicero, IL",
        "Latitude": "41.85",
        "Longitude": "-87.75",
        "Population": 1000000,
    },
    "469": {
        "Metro Area": "Dallas, TX",
        "Latitude": "32.78",
        "Longitude": "-96.8",
        "Population": 2600000,
    },
    "470": {
        "Metro Area": "Atlanta, GA",
        "Latitude": "33.75",
        "Longitude": "-84.39",
        "Population": 5500000,
    },
    "472": {
        "Metro Area": "Fayetteville, NC",
        "Latitude": "35.05",
        "Longitude": "-78.88",
        "Population": 900000,
    },
    "473": {
        "Metro Area": "Grenada",
        "Latitude": "12.11",
        "Longitude": "-61.68",
        "Population": 113000,
    },
    "475": {
        "Metro Area": "Bridgeport, CT",
        "Latitude": "41.18",
        "Longitude": "-73.19",
        "Population": 1400000,
    },
    "478": {
        "Metro Area": "Macon, GA",
        "Latitude": "32.84",
        "Longitude": "-83.63",
        "Population": 550000,
    },
    "479": {
        "Metro Area": "Fort Smith, AR",
        "Latitude": "35.39",
        "Longitude": "-94.42",
        "Population": 600000,
    },
    "480": {
        "Metro Area": "Phoenix, AZ",
        "Latitude": "33.45",
        "Longitude": "-112.07",
        "Population": 1800000,
    },
    "483": {
        "Metro Area": "Montgomery, AL",
        "Latitude": "32.38",
        "Longitude": "-86.3",
        "Population": 550000,
    },
    "484": {
        "Metro Area": "Allentown, PA",
        "Latitude": "40.61",
        "Longitude": "-75.49",
        "Population": 1800000,
    },
    "501": {
        "Metro Area": "Little Rock, AR",
        "Latitude": "34.75",
        "Longitude": "-92.29",
        "Population": 750000,
    },
    "502": {
        "Metro Area": "Louisville, KY",
        "Latitude": "38.25",
        "Longitude": "-85.76",
        "Population": 1300000,
    },
    "503": {
        "Metro Area": "Portland, OR",
        "Latitude": "45.52",
        "Longitude": "-122.68",
        "Population": 2500000,
    },
    "504": {
        "Metro Area": "New Orleans, LA",
        "Latitude": "29.95",
        "Longitude": "-90.07",
        "Population": 900000,
    },
    "505": {
        "Metro Area": "Albuquerque, NM",
        "Latitude": "35.08",
        "Longitude": "-106.65",
        "Population": 1200000,
    },
    "507": {
        "Metro Area": "Rochester, MN",
        "Latitude": "44.02",
        "Longitude": "-92.46",
        "Population": 600000,
    },
    "508": {
        "Metro Area": "Worcester, MA",
        "Latitude": "42.26",
        "Longitude": "-71.8",
        "Population": 1200000,
    },
    "509": {
        "Metro Area": "Spokane, WA",
        "Latitude": "47.66",
        "Longitude": "-117.43",
        "Population": 1100000,
    },
    "510": {
        "Metro Area": "Oakland, CA",
        "Latitude": "37.80",
        "Longitude": "-122.27",
        "Population": 1600000,
    },
    "512": {
        "Metro Area": "Austin, TX",
        "Latitude": "30.27",
        "Longitude": "-97.74",
        "Population": 2300000,
    },
    "513": {
        "Metro Area": "Cincinnati, OH",
        "Latitude": "39.10",
        "Longitude": "-84.51",
        "Population": 1700000,
    },
    "515": {
        "Metro Area": "Des Moines, IA",
        "Latitude": "41.59",
        "Longitude": "-93.61",
        "Population": 800000,
    },
    "516": {
        "Metro Area": "Hempstead, NY",
        "Latitude": "40.71",
        "Longitude": "-73.62",
        "Population": 1370000,
    },
    "517": {
        "Metro Area": "Lansing, MI",
        "Latitude": "42.73",
        "Longitude": "-84.56",
        "Population": 700000,
    },
    "518": {
        "Metro Area": "Albany, NY",
        "Latitude": "42.65",
        "Longitude": "-73.76",
        "Population": 1100000,
    },
    "520": {
        "Metro Area": "Tucson, AZ",
        "Latitude": "32.22",
        "Longitude": "-110.97",
        "Population": 1100000,
    },
    "530": {
        "Metro Area": "Redding, CA",
        "Latitude": "40.59",
        "Longitude": "-122.39",
        "Population": 1000000,
    },
    "531": {
        "Metro Area": "Omaha, NE",
        "Latitude": "41.25",
        "Longitude": "-95.94",
        "Population": 1400000,
    },
    "534": {
        "Metro Area": "Eau Claire, WI",
        "Latitude": "44.81",
        "Longitude": "-91.5",
        "Population": 500000,
    },
    "539": {
        "Metro Area": "Tulsa, OK",
        "Latitude": "36.15",
        "Longitude": "-95.99",
        "Population": 1150000,
    },
    "540": {
        "Metro Area": "Roanoke, VA",
        "Latitude": "37.27",
        "Longitude": "-79.94",
        "Population": 900000,
    },
    "541": {
        "Metro Area": "Eugene, OR",
        "Latitude": "44.05",
        "Longitude": "-123.09",
        "Population": 1700000,
    },
    "548": {
        "Metro Area": "London, ON",
        "Latitude": "42.98",
        "Longitude": "-81.24",
        "Population": 550000,
    },
    "551": {
        "Metro Area": "Jersey City, NJ",
        "Latitude": "40.73",
        "Longitude": "-74.08",
        "Population": 1700000,
    },
    "557": {
        "Metro Area": "St. Louis, MO",
        "Latitude": "38.63",
        "Longitude": "-90.2",
        "Population": 1300000,
    },
    "559": {
        "Metro Area": "Fresno, CA",
        "Latitude": "36.74",
        "Longitude": "-119.77",
        "Population": 1150000,
    },
    "561": {
        "Metro Area": "West Palm Beach, FL",
        "Latitude": "26.71",
        "Longitude": "-80.05",
        "Population": 1500000,
    },
    "562": {
        "Metro Area": "Long Beach, CA",
        "Latitude": "33.77",
        "Longitude": "-118.19",
        "Population": 1800000,
    },
    "563": {
        "Metro Area": "Davenport, IA",
        "Latitude": "41.52",
        "Longitude": "-90.58",
        "Population": 450000,
    },
    "564": {
        "Metro Area": "Seattle, WA",
        "Latitude": "47.61",
        "Longitude": "-122.33",
        "Population": 1900000,
    },
    "567": {
        "Metro Area": "Toledo, OH",
        "Latitude": "41.66",
        "Longitude": "-83.54",
        "Population": 1000000,
    },
    "570": {
        "Metro Area": "Scranton, PA",
        "Latitude": "41.41",
        "Longitude": "-75.66",
        "Population": 800000,
    },
    "571": {
        "Metro Area": "Arlington, VA",
        "Latitude": "38.88",
        "Longitude": "-77.1",
        "Population": 2400000,
    },
    "572": {
        "Metro Area": "Oklahoma City, OK",
        "Latitude": "35.47",
        "Longitude": "-97.52",
        "Population": 1400000,
    },
    "573": {
        "Metro Area": "Columbia, MO",
        "Latitude": "38.95",
        "Longitude": "-92.33",
        "Population": 800000,
    },
    "574": {
        "Metro Area": "South Bend, IN",
        "Latitude": "41.68",
        "Longitude": "-86.25",
        "Population": 600000,
    },
    "575": {
        "Metro Area": "Las Cruces, NM",
        "Latitude": "32.31",
        "Longitude": "-106.78",
        "Population": 900000,
    },
    "580": {
        "Metro Area": "Lawton, OK",
        "Latitude": "34.61",
        "Longitude": "-98.39",
        "Population": 650000,
    },
    "581": {
        "Metro Area": "Quebec, QC",
        "Latitude": "46.81",
        "Longitude": "-71.21",
        "Population": 850000,
    },
    "582": {
        "Metro Area": "Erie, PA",
        "Latitude": "42.13",
        "Longitude": "-80.09",
        "Population": 550000,
    },
    "585": {
        "Metro Area": "Rochester, NY",
        "Latitude": "43.15",
        "Longitude": "-77.61",
        "Population": 1000000,
    },
    "586": {
        "Metro Area": "Warren, MI",
        "Latitude": "42.49",
        "Longitude": "-83.03",
        "Population": 1000000,
    },
    "601": {
        "Metro Area": "Jackson, MS",
        "Latitude": "32.30",
        "Longitude": "-90.18",
        "Population": 1000000,
    },
    "602": {
        "Metro Area": "Phoenix, AZ",
        "Latitude": "33.45",
        "Longitude": "-112.07",
        "Population": 1650000,
    },
    "603": {
        "Metro Area": "Manchester, NH",
        "Latitude": "42.99",
        "Longitude": "-71.46",
        "Population": 1380000,
    },
    "605": {
        "Metro Area": "Sioux Falls, SD",
        "Latitude": "43.55",
        "Longitude": "-96.73",
        "Population": 900000,
    },
    "606": {
        "Metro Area": "Ashland, KY",
        "Latitude": "38.47",
        "Longitude": "-82.64",
        "Population": 700000,
    },
    "607": {
        "Metro Area": "Binghamton, NY",
        "Latitude": "42.10",
        "Longitude": "-75.91",
        "Population": 500000,
    },
    "608": {
        "Metro Area": "Madison, WI",
        "Latitude": "43.07",
        "Longitude": "-89.4",
        "Population": 1000000,
    },
    "609": {
        "Metro Area": "Trenton, NJ",
        "Latitude": "40.22",
        "Longitude": "-74.76",
        "Population": 1200000,
    },
    "610": {
        "Metro Area": "Allentown, PA",
        "Latitude": "40.61",
        "Longitude": "-75.49",
        "Population": 1800000,
    },
    "612": {
        "Metro Area": "Minneapolis, MN",
        "Latitude": "44.98",
        "Longitude": "-93.26",
        "Population": 1200000,
    },
    "614": {
        "Metro Area": "Columbus, OH",
        "Latitude": "39.96",
        "Longitude": "-83.0",
        "Population": 1300000,
    },
    "615": {
        "Metro Area": "Nashville, TN",
        "Latitude": "36.16",
        "Longitude": "-86.78",
        "Population": 1300000,
    },
    "616": {
        "Metro Area": "Grand Rapids, MI",
        "Latitude": "42.96",
        "Longitude": "-85.67",
        "Population": 1100000,
    },
    "617": {
        "Metro Area": "Boston, MA",
        "Latitude": "42.36",
        "Longitude": "-71.06",
        "Population": 1600000,
    },
    "618": {
        "Metro Area": "Belleville, IL",
        "Latitude": "38.52",
        "Longitude": "-89.98",
        "Population": 700000,
    },
    "619": {
        "Metro Area": "San Diego, CA",
        "Latitude": "32.72",
        "Longitude": "-117.16",
        "Population": 1400000,
    },
    "620": {
        "Metro Area": "Hutchinson, KS",
        "Latitude": "38.06",
        "Longitude": "-97.93",
        "Population": 650000,
    },
    "621": {
        "Metro Area": "Houston, TX",
        "Latitude": "29.76",
        "Longitude": "-95.36",
        "Population": 7100000,
    },
    "623": {
        "Metro Area": "Phoenix, AZ",
        "Latitude": "33.45",
        "Longitude": "-112.07",
        "Population": 1300000,
    },
    "624": {
        "Metro Area": "Buffalo, NY",
        "Latitude": "42.89",
        "Longitude": "-78.88",
        "Population": 1100000,
    },
    "626": {
        "Metro Area": "Pasadena, CA",
        "Latitude": "34.15",
        "Longitude": "-118.14",
        "Population": 1500000,
    },
    "628": {
        "Metro Area": "San Francisco, CA",
        "Latitude": "37.77",
        "Longitude": "-122.42",
        "Population": 1600000,
    },
    "629": {
        "Metro Area": "Nashville, TN",
        "Latitude": "36.16",
        "Longitude": "-86.78",
        "Population": 1300000,
    },
    "630": {
        "Metro Area": "Aurora, IL",
        "Latitude": "41.76",
        "Longitude": "-88.32",
        "Population": 1500000,
    },
    "631": {
        "Metro Area": "Brentwood, NY",
        "Latitude": "40.78",
        "Longitude": "-73.24",
        "Population": 1500000,
    },
    "636": {
        "Metro Area": "O'Fallon, MO",
        "Latitude": "38.81",
        "Longitude": "-90.7",
        "Population": 800000,
    },
    "640": {
        "Metro Area": "Trenton, NJ",
        "Latitude": "40.22",
        "Longitude": "-74.76",
        "Population": 1200000,
    },
    "641": {
        "Metro Area": "Mason City, IA",
        "Latitude": "43.15",
        "Longitude": "-93.2",
        "Population": 450000,
    },
    "645": {
        "Metro Area": "Miami, FL",
        "Latitude": "25.76",
        "Longitude": "-80.19",
        "Population": 2700000,
    },
    "646": {
        "Metro Area": "New York, NY",
        "Latitude": "40.71",
        "Longitude": "-74.01",
        "Population": 1650000,
    },
    "647": {
        "Metro Area": "Toronto, ON",
        "Latitude": "43.65",
        "Longitude": "-79.38",
        "Population": 3000000,
    },
    "650": {
        "Metro Area": "San Mateo, CA",
        "Latitude": "37.56",
        "Longitude": "-122.31",
        "Population": 770000,
    },
    "651": {
        "Metro Area": "St. Paul, MN",
        "Latitude": "44.95",
        "Longitude": "-93.09",
        "Population": 1100000,
    },
    "656": {
        "Metro Area": "Tampa, FL",
        "Latitude": "27.95",
        "Longitude": "-82.46",
        "Population": 1500000,
    },
    "657": {
        "Metro Area": "Anaheim, CA",
        "Latitude": "33.84",
        "Longitude": "-117.91",
        "Population": 1400000,
    },
    "659": {
        "Metro Area": "Birmingham, AL",
        "Latitude": "33.52",
        "Longitude": "-86.8",
        "Population": 1100000,
    },
    "660": {
        "Metro Area": "Sedalia, MO",
        "Latitude": "38.70",
        "Longitude": "-93.23",
        "Population": 400000,
    },
    "661": {
        "Metro Area": "Bakersfield, CA",
        "Latitude": "35.37",
        "Longitude": "-119.02",
        "Population": 1300000,
    },
    "662": {
        "Metro Area": "Southaven, MS",
        "Latitude": "34.99",
        "Longitude": "-90.0",
        "Population": 800000,
    },
    "667": {
        "Metro Area": "Baltimore, MD",
        "Latitude": "39.29",
        "Longitude": "-76.61",
        "Population": 2800000,
    },
    "669": {
        "Metro Area": "San Jose, CA",
        "Latitude": "37.34",
        "Longitude": "-121.89",
        "Population": 1800000,
    },
    "670": {
        "Metro Area": "Saipan, MP",
        "Latitude": "15.18",
        "Longitude": "-145.75",
        "Population": 51000,
    },
    "671": {
        "Metro Area": "Dededo, GU",
        "Latitude": "13.52",
        "Longitude": "-144.84",
        "Population": 170000,
    },
    "678": {
        "Metro Area": "Atlanta, GA",
        "Latitude": "33.75",
        "Longitude": "-84.39",
        "Population": 5500000,
    },
    "679": {
        "Metro Area": "Detroit, MI",
        "Latitude": "42.33",
        "Longitude": "-83.05",
        "Population": 1500000,
    },
    "680": {
        "Metro Area": "Syracuse, NY",
        "Latitude": "43.05",
        "Longitude": "-76.15",
        "Population": 1200000,
    },
    "681": {
        "Metro Area": "Charleston, WV",
        "Latitude": "38.35",
        "Longitude": "-81.63",
        "Population": 1770000,
    },
    "682": {
        "Metro Area": "Fort Worth, TX",
        "Latitude": "32.75",
        "Longitude": "-97.33",
        "Population": 2100000,
    },
    "684": {
        "Metro Area": "Pago Pago, AS",
        "Latitude": "14.28",
        "Longitude": "-170.7",
        "Population": 50000,
    },
    "686": {
        "Metro Area": "Richmond, VA",
        "Latitude": "37.54",
        "Longitude": "-77.43",
        "Population": 1300000,
    },
    "689": {
        "Metro Area": "Orlando, FL",
        "Latitude": "28.54",
        "Longitude": "-81.38",
        "Population": 2000000,
    },
    "701": {
        "Metro Area": "Fargo, ND",
        "Latitude": "46.88",
        "Longitude": "-96.79",
        "Population": 780000,
    },
    "702": {
        "Metro Area": "Las Vegas, NV",
        "Latitude": "36.17",
        "Longitude": "-115.14",
        "Population": 2300000,
    },
    "703": {
        "Metro Area": "Arlington, VA",
        "Latitude": "38.88",
        "Longitude": "-77.1",
        "Population": 2400000,
    },
    "704": {
        "Metro Area": "Charlotte, NC",
        "Latitude": "35.23",
        "Longitude": "-80.84",
        "Population": 2700000,
    },
    "706": {
        "Metro Area": "Augusta, GA",
        "Latitude": "33.47",
        "Longitude": "-81.97",
        "Population": 1500000,
    },
    "707": {
        "Metro Area": "Santa Rosa, CA",
        "Latitude": "38.44",
        "Longitude": "-122.71",
        "Population": 1000000,
    },
    "708": {
        "Metro Area": "Cicero, IL",
        "Latitude": "41.85",
        "Longitude": "-87.75",
        "Population": 1000000,
    },
    "712": {
        "Metro Area": "Sioux City, IA",
        "Latitude": "42.50",
        "Longitude": "-96.4",
        "Population": 400000,
    },
    "713": {
        "Metro Area": "Houston, TX",
        "Latitude": "29.76",
        "Longitude": "-95.36",
        "Population": 7100000,
    },
    "714": {
        "Metro Area": "Anaheim, CA",
        "Latitude": "33.84",
        "Longitude": "-117.91",
        "Population": 1400000,
    },
    "715": {
        "Metro Area": "Eau Claire, WI",
        "Latitude": "44.81",
        "Longitude": "-91.5",
        "Population": 500000,
    },
    "716": {
        "Metro Area": "Buffalo, NY",
        "Latitude": "42.89",
        "Longitude": "-78.88",
        "Population": 1100000,
    },
    "717": {
        "Metro Area": "Lancaster, PA",
        "Latitude": "40.04",
        "Longitude": "-76.31",
        "Population": 1200000,
    },
    "718": {
        "Metro Area": "New York, NY",
        "Latitude": "40.71",
        "Longitude": "-74.01",
        "Population": 7000000,
    },
    "719": {
        "Metro Area": "Colorado Springs, CO",
        "Latitude": "38.83",
        "Longitude": "-104.82",
        "Population": 850000,
    },
    "720": {
        "Metro Area": "Denver, CO",
        "Latitude": "39.74",
        "Longitude": "-104.99",
        "Population": 2900000,
    },
    "724": {
        "Metro Area": "New Castle, PA",
        "Latitude": "41.00",
        "Longitude": "-80.35",
        "Population": 900000,
    },
    "725": {
        "Metro Area": "Las Vegas, NV",
        "Latitude": "36.17",
        "Longitude": "-115.14",
        "Population": 2300000,
    },
    "726": {
        "Metro Area": "San Antonio, TX",
        "Latitude": "29.42",
        "Longitude": "-98.49",
        "Population": 2600000,
    },
    "727": {
        "Metro Area": "St. Petersburg, FL",
        "Latitude": "27.76",
        "Longitude": "-82.64",
        "Population": 1000000,
    },
    "728": {
        "Metro Area": "West Palm Beach, FL",
        "Latitude": "26.71",
        "Longitude": "-80.05",
        "Population": 1500000,
    },
    "729": {
        "Metro Area": "Chattanooga, TN",
        "Latitude": "35.05",
        "Longitude": "-85.31",
        "Population": 950000,
    },
    "730": {
        "Metro Area": "Belleville, IL",
        "Latitude": "38.52",
        "Longitude": "-89.98",
        "Population": 700000,
    },
    "731": {
        "Metro Area": "Jackson, TN",
        "Latitude": "35.61",
        "Longitude": "-88.82",
        "Population": 400000,
    },
    "732": {
        "Metro Area": "Toms River, NJ",
        "Latitude": "39.96",
        "Longitude": "-74.2",
        "Population": 1900000,
    },
    "734": {
        "Metro Area": "Ann Arbor, MI",
        "Latitude": "42.28",
        "Longitude": "-83.74",
        "Population": 850000,
    },
    "737": {
        "Metro Area": "Austin, TX",
        "Latitude": "30.27",
        "Longitude": "-97.74",
        "Population": 2300000,
    },
    "738": {
        "Metro Area": "Los Angeles, CA",
        "Latitude": "34.05",
        "Longitude": "-118.24",
        "Population": 2000000,
    },
    "740": {
        "Metro Area": "Newark, OH",
        "Latitude": "40.06",
        "Longitude": "-82.4",
        "Population": 1000000,
    },
    "743": {
        "Metro Area": "Greensboro, NC",
        "Latitude": "36.07",
        "Longitude": "-79.79",
        "Population": 1600000,
    },
    "747": {
        "Metro Area": "Los Angeles, CA",
        "Latitude": "34.05",
        "Longitude": "-118.24",
        "Population": 2200000,
    },
    "748": {
        "Metro Area": "Fort Collins, CO",
        "Latitude": "40.59",
        "Longitude": "-105.08",
        "Population": 900000,
    },
    "754": {
        "Metro Area": "Fort Lauderdale, FL",
        "Latitude": "26.12",
        "Longitude": "-80.14",
        "Population": 1950000,
    },
    "757": {
        "Metro Area": "Virginia Beach, VA",
        "Latitude": "36.85",
        "Longitude": "-75.98",
        "Population": 1800000,
    },
    "760": {
        "Metro Area": "Oceanside, CA",
        "Latitude": "33.19",
        "Longitude": "-117.38",
        "Population": 1200000,
    },
    "762": {
        "Metro Area": "Augusta, GA",
        "Latitude": "33.47",
        "Longitude": "-81.97",
        "Population": 1500000,
    },
    "763": {
        "Metro Area": "Brooklyn Park, MN",
        "Latitude": "45.09",
        "Longitude": "-93.36",
        "Population": 1300000,
    },
    "765": {
        "Metro Area": "Muncie, IN",
        "Latitude": "40.19",
        "Longitude": "-85.39",
        "Population": 700000,
    },
    "769": {
        "Metro Area": "Jackson, MS",
        "Latitude": "32.30",
        "Longitude": "-90.18",
        "Population": 1000000,
    },
    "770": {
        "Metro Area": "Atlanta, GA",
        "Latitude": "33.75",
        "Longitude": "-84.39",
        "Population": 5500000,
    },
    "771": {
        "Metro Area": "Washington, DC",
        "Latitude": "38.90",
        "Longitude": "-77.04",
        "Population": 700000,
    },
    "772": {
        "Metro Area": "Port St. Lucie, FL",
        "Latitude": "27.29",
        "Longitude": "-80.35",
        "Population": 650000,
    },
    "773": {
        "Metro Area": "Chicago, IL",
        "Latitude": "41.88",
        "Longitude": "-87.63",
        "Population": 2750000,
    },
    "774": {
        "Metro Area": "Worcester, MA",
        "Latitude": "42.26",
        "Longitude": "-71.8",
        "Population": 1200000,
    },
    "775": {
        "Metro Area": "Reno, NV",
        "Latitude": "39.53",
        "Longitude": "-119.81",
        "Population": 800000,
    },
    "779": {
        "Metro Area": "Rockford, IL",
        "Latitude": "42.27",
        "Longitude": "-89.09",
        "Population": 650000,
    },
    "780": {
        "Metro Area": "Edmonton, AB",
        "Latitude": "53.54",
        "Longitude": "-113.49",
        "Population": 1500000,
    },
    "781": {
        "Metro Area": "Boston, MA",
        "Latitude": "42.36",
        "Longitude": "-71.06",
        "Population": 2000000,
    },
    "785": {
        "Metro Area": "Topeka, KS",
        "Latitude": "39.05",
        "Longitude": "-95.68",
        "Population": 600000,
    },
    "786": {
        "Metro Area": "Miami, FL",
        "Latitude": "25.76",
        "Longitude": "-80.19",
        "Population": 2700000,
    },
    "787": {
        "Metro Area": "San Juan, PR",
        "Latitude": "18.47",
        "Longitude": "-66.12",
        "Population": 3200000,
    },
    "801": {
        "Metro Area": "Salt Lake City, UT",
        "Latitude": "40.76",
        "Longitude": "-111.89",
        "Population": 1250000,
    },
    "802": {
        "Metro Area": "Burlington, VT",
        "Latitude": "44.48",
        "Longitude": "-73.21",
        "Population": 645000,
    },
    "803": {
        "Metro Area": "Columbia, SC",
        "Latitude": "34.00",
        "Longitude": "-81.03",
        "Population": 1400000,
    },
    "804": {
        "Metro Area": "Richmond, VA",
        "Latitude": "37.54",
        "Longitude": "-77.43",
        "Population": 1300000,
    },
    "805": {
        "Metro Area": "Oxnard, CA",
        "Latitude": "34.20",
        "Longitude": "-119.18",
        "Population": 1400000,
    },
    "806": {
        "Metro Area": "Lubbock, TX",
        "Latitude": "33.58",
        "Longitude": "-101.86",
        "Population": 650000,
    },
    "808": {
        "Metro Area": "Honolulu, HI",
        "Latitude": "21.31",
        "Longitude": "-157.86",
        "Population": 1450000,
    },
    "810": {
        "Metro Area": "Flint, MI",
        "Latitude": "43.01",
        "Longitude": "-83.69",
        "Population": 550000,
    },
    "812": {
        "Metro Area": "Evansville, IN",
        "Latitude": "37.97",
        "Longitude": "-87.56",
        "Population": 900000,
    },
    "813": {
        "Metro Area": "Tampa, FL",
        "Latitude": "27.95",
        "Longitude": "-82.46",
        "Population": 1500000,
    },
    "814": {
        "Metro Area": "Erie, PA",
        "Latitude": "42.13",
        "Longitude": "-80.09",
        "Population": 800000,
    },
    "815": {
        "Metro Area": "Rockford, IL",
        "Latitude": "42.27",
        "Longitude": "-89.09",
        "Population": 650000,
    },
    "816": {
        "Metro Area": "Kansas City, MO",
        "Latitude": "39.10",
        "Longitude": "-94.58",
        "Population": 1600000,
    },
    "817": {
        "Metro Area": "Fort Worth, TX",
        "Latitude": "32.75",
        "Longitude": "-97.33",
        "Population": 2100000,
    },
    "818": {
        "Metro Area": "Los Angeles, CA",
        "Latitude": "34.05",
        "Longitude": "-118.24",
        "Population": 2200000,
    },
    "820": {
        "Metro Area": "Oxnard, CA",
        "Latitude": "34.20",
        "Longitude": "-119.18",
        "Population": 1400000,
    },
    "821": {
        "Metro Area": "Greenville, SC",
        "Latitude": "34.85",
        "Longitude": "-82.4",
        "Population": 1500000,
    },
    "825": {
        "Metro Area": "Calgary, AB",
        "Latitude": "51.05",
        "Longitude": "-114.07",
        "Population": 1600000,
    },
    "826": {
        "Metro Area": "Roanoke, VA",
        "Latitude": "37.27",
        "Longitude": "-79.94",
        "Population": 900000,
    },
    "828": {
        "Metro Area": "Asheville, NC",
        "Latitude": "35.60",
        "Longitude": "-82.55",
        "Population": 950000,
    },
    "830": {
        "Metro Area": "New Braunfels, TX",
        "Latitude": "29.70",
        "Longitude": "-98.12",
        "Population": 600000,
    },
    "831": {
        "Metro Area": "Salinas, CA",
        "Latitude": "36.68",
        "Longitude": "-121.66",
        "Population": 750000,
    },
    "832": {
        "Metro Area": "Houston, TX",
        "Latitude": "29.76",
        "Longitude": "-95.36",
        "Population": 7100000,
    },
    "835": {
        "Metro Area": "Allentown, PA",
        "Latitude": "40.61",
        "Longitude": "-75.49",
        "Population": 1800000,
    },
    "837": {
        "Metro Area": "Redding, CA",
        "Latitude": "40.59",
        "Longitude": "-122.39",
        "Population": 1000000,
    },
    "838": {
        "Metro Area": "Albany, NY",
        "Latitude": "42.65",
        "Longitude": "-73.76",
        "Population": 1100000,
    },
    "839": {
        "Metro Area": "Columbia, SC",
        "Latitude": "34.00",
        "Longitude": "-81.03",
        "Population": 1400000,
    },
    "840": {
        "Metro Area": "San Bernardino, CA",
        "Latitude": "34.11",
        "Longitude": "-117.29",
        "Population": 2200000,
    },
    "843": {
        "Metro Area": "Charleston, SC",
        "Latitude": "32.78",
        "Longitude": "-79.93",
        "Population": 1400000,
    },
    "845": {
        "Metro Area": "New City, NY",
        "Latitude": "41.15",
        "Longitude": "-73.99",
        "Population": 900000,
    },
    "847": {
        "Metro Area": "Elgin, IL",
        "Latitude": "42.04",
        "Longitude": "-88.28",
        "Population": 1800000,
    },
    "848": {
        "Metro Area": "Toms River, NJ",
        "Latitude": "39.96",
        "Longitude": "-74.2",
        "Population": 1900000,
    },
    "850": {
        "Metro Area": "Tallahassee, FL",
        "Latitude": "30.44",
        "Longitude": "-84.28",
        "Population": 1500000,
    },
    "854": {
        "Metro Area": "Charleston, SC",
        "Latitude": "32.78",
        "Longitude": "-79.93",
        "Population": 1400000,
    },
    "856": {
        "Metro Area": "Camden, NJ",
        "Latitude": "39.93",
        "Longitude": "-75.12",
        "Population": 1250000,
    },
    "857": {
        "Metro Area": "Boston, MA",
        "Latitude": "42.36",
        "Longitude": "-71.06",
        "Population": 1600000,
    },
    "858": {
        "Metro Area": "San Diego, CA",
        "Latitude": "32.72",
        "Longitude": "-117.16",
        "Population": 1900000,
    },
    "859": {
        "Metro Area": "Lexington, KY",
        "Latitude": "38.05",
        "Longitude": "-84.5",
        "Population": 750000,
    },
    "860": {
        "Metro Area": "Hartford, CT",
        "Latitude": "41.76",
        "Longitude": "-72.69",
        "Population": 1200000,
    },
    "862": {
        "Metro Area": "Newark, NJ",
        "Latitude": "40.74",
        "Longitude": "-74.17",
        "Population": 2150000,
    },
    "863": {
        "Metro Area": "Lakeland, FL",
        "Latitude": "28.04",
        "Longitude": "-81.95",
        "Population": 1100000,
    },
    "864": {
        "Metro Area": "Greenville, SC",
        "Latitude": "34.85",
        "Longitude": "-82.4",
        "Population": 1500000,
    },
    "865": {
        "Metro Area": "Knoxville, TN",
        "Latitude": "35.96",
        "Longitude": "-83.92",
        "Population": 900000,
    },
    "870": {
        "Metro Area": "Jonesboro, AR",
        "Latitude": "35.84",
        "Longitude": "-90.7",
        "Population": 700000,
    },
    "872": {
        "Metro Area": "Chicago, IL",
        "Latitude": "41.88",
        "Longitude": "-87.63",
        "Population": 2750000,
    },
    "878": {
        "Metro Area": "Pittsburgh, PA",
        "Latitude": "40.44",
        "Longitude": "-79.99",
        "Population": 2600000,
    },
    "901": {
        "Metro Area": "Memphis, TN",
        "Latitude": "35.15",
        "Longitude": "-90.05",
        "Population": 1350000,
    },
    "903": {
        "Metro Area": "Tyler, TX",
        "Latitude": "32.35",
        "Longitude": "-95.3",
        "Population": 1000000,
    },
    "904": {
        "Metro Area": "Jacksonville, FL",
        "Latitude": "30.33",
        "Longitude": "-81.66",
        "Population": 1600000,
    },
    "906": {
        "Metro Area": "Marquette, MI",
        "Latitude": "46.54",
        "Longitude": "-87.4",
        "Population": 300000,
    },
    "907": {
        "Metro Area": "Anchorage, AK",
        "Latitude": "61.22",
        "Longitude": "-149.9",
        "Population": 733000,
    },
    "908": {
        "Metro Area": "Elizabeth, NJ",
        "Latitude": "40.66",
        "Longitude": "-74.21",
        "Population": 900000,
    },
    "909": {
        "Metro Area": "San Bernardino, CA",
        "Latitude": "34.11",
        "Longitude": "-117.29",
        "Population": 2200000,
    },
    "910": {
        "Metro Area": "Fayetteville, NC",
        "Latitude": "35.05",
        "Longitude": "-78.88",
        "Population": 900000,
    },
    "912": {
        "Metro Area": "Savannah, GA",
        "Latitude": "32.08",
        "Longitude": "-81.09",
        "Population": 600000,
    },
    "913": {
        "Metro Area": "Overland Park, KS",
        "Latitude": "38.98",
        "Longitude": "-94.67",
        "Population": 1000000,
    },
    "914": {
        "Metro Area": "Yonkers, NY",
        "Latitude": "40.93",
        "Longitude": "-73.89",
        "Population": 1000000,
    },
    "915": {
        "Metro Area": "El Paso, TX",
        "Latitude": "31.76",
        "Longitude": "-106.49",
        "Population": 870000,
    },
    "916": {
        "Metro Area": "Sacramento, CA",
        "Latitude": "38.58",
        "Longitude": "-121.49",
        "Population": 1500000,
    },
    "917": {
        "Metro Area": "New York, NY",
        "Latitude": "40.71",
        "Longitude": "-74.01",
        "Population": 8650000,
    },
    "918": {
        "Metro Area": "Tulsa, OK",
        "Latitude": "36.15",
        "Longitude": "-95.99",
        "Population": 1150000,
    },
    "919": {
        "Metro Area": "Raleigh, NC",
        "Latitude": "35.77",
        "Longitude": "-78.64",
        "Population": 2100000,
    },
    "920": {
        "Metro Area": "Green Bay, WI",
        "Latitude": "44.51",
        "Longitude": "-88.01",
        "Population": 950000,
    },
    "925": {
        "Metro Area": "Concord, CA",
        "Latitude": "37.98",
        "Longitude": "-122.03",
        "Population": 1150000,
    },
    "928": {
        "Metro Area": "Yuma, AZ",
        "Latitude": "32.73",
        "Longitude": "-114.62",
        "Population": 750000,
    },
    "929": {
        "Metro Area": "New York, NY",
        "Latitude": "40.71",
        "Longitude": "-74.01",
        "Population": 7000000,
    },
    "930": {
        "Metro Area": "Evansville, IN",
        "Latitude": "37.97",
        "Longitude": "-87.56",
        "Population": 900000,
    },
    "931": {
        "Metro Area": "Clarksville, TN",
        "Latitude": "36.53",
        "Longitude": "-87.36",
        "Population": 600000,
    },
    "934": {
        "Metro Area": "Brentwood, NY",
        "Latitude": "40.78",
        "Longitude": "-73.24",
        "Population": 1500000,
    },
    "936": {
        "Metro Area": "Conroe, TX",
        "Latitude": "30.31",
        "Longitude": "-95.46",
        "Population": 650000,
    },
    "937": {
        "Metro Area": "Dayton, OH",
        "Latitude": "39.76",
        "Longitude": "-84.19",
        "Population": 800000,
    },
    "938": {
        "Metro Area": "Huntsville, AL",
        "Latitude": "34.73",
        "Longitude": "-86.59",
        "Population": 1000000,
    },
    "939": {
        "Metro Area": "San Juan, PR",
        "Latitude": "18.47",
        "Longitude": "-66.12",
        "Population": 3200000,
    },
    "940": {
        "Metro Area": "Denton, TX",
        "Latitude": "33.21",
        "Longitude": "-97.13",
        "Population": 900000,
    },
    "941": {
        "Metro Area": "North Port, FL",
        "Latitude": "27.04",
        "Longitude": "-82.23",
        "Population": 800000,
    },
    "943": {
        "Metro Area": "Atlanta, GA",
        "Latitude": "33.75",
        "Longitude": "-84.39",
        "Population": 5500000,
    },
    "945": {
        "Metro Area": "Dallas, TX",
        "Latitude": "32.78",
        "Longitude": "-96.8",
        "Population": 2600000,
    },
    "947": {
        "Metro Area": "Troy, MI",
        "Latitude": "42.61",
        "Longitude": "-83.15",
        "Population": 1200000,
    },
    "948": {
        "Metro Area": "Virginia Beach, VA",
        "Latitude": "36.85",
        "Longitude": "-75.98",
        "Population": 1800000,
    },
    "949": {
        "Metro Area": "Irvine, CA",
        "Latitude": "33.68",
        "Longitude": "-117.83",
        "Population": 1400000,
    },
    "951": {
        "Metro Area": "Riverside, CA",
        "Latitude": "33.95",
        "Longitude": "-117.39",
        "Population": 2400000,
    },
    "952": {
        "Metro Area": "Bloomington, MN",
        "Latitude": "44.84",
        "Longitude": "-93.29",
        "Population": 1100000,
    },
    "954": {
        "Metro Area": "Fort Lauderdale, FL",
        "Latitude": "26.12",
        "Longitude": "-80.14",
        "Population": 1950000,
    },
    "956": {
        "Metro Area": "Laredo, TX",
        "Latitude": "27.53",
        "Longitude": "-99.48",
        "Population": 1300000,
    },
    "959": {
        "Metro Area": "Hartford, CT",
        "Latitude": "41.76",
        "Longitude": "-72.69",
        "Population": 1200000,
    },
    "970": {
        "Metro Area": "Fort Collins, CO",
        "Latitude": "40.59",
        "Longitude": "-105.08",
        "Population": 900000,
    },
    "971": {
        "Metro Area": "Portland, OR",
        "Latitude": "45.52",
        "Longitude": "-122.68",
        "Population": 2500000,
    },
    "972": {
        "Metro Area": "Dallas, TX",
        "Latitude": "32.78",
        "Longitude": "-96.8",
        "Population": 2600000,
    },
    "973": {
        "Metro Area": "Newark, NJ",
        "Latitude": "40.74",
        "Longitude": "-74.17",
        "Population": 2150000,
    },
    "975": {
        "Metro Area": "Kansas City, MO",
        "Latitude": "39.10",
        "Longitude": "-94.58",
        "Population": 1600000,
    },
    "978": {
        "Metro Area": "Lowell, MA",
        "Latitude": "42.63",
        "Longitude": "-71.32",
        "Population": 1100000,
    },
    "979": {
        "Metro Area": "College Station, TX",
        "Latitude": "30.63",
        "Longitude": "-96.33",
        "Population": 500000,
    },
    "980": {
        "Metro Area": "Charlotte, NC",
        "Latitude": "35.23",
        "Longitude": "-80.84",
        "Population": 2700000,
    },
    "983": {
        "Metro Area": "Denver, CO",
        "Latitude": "39.74",
        "Longitude": "-104.99",
        "Population": 2900000,
    },
    "984": {
        "Metro Area": "Raleigh, NC",
        "Latitude": "35.77",
        "Longitude": "-78.64",
        "Population": 2100000,
    },
    "985": {
        "Metro Area": "Houma, LA",
        "Latitude": "29.60",
        "Longitude": "-90.72",
        "Population": 600000,
    },
    "986": {
        "Metro Area": "Boise, ID",
        "Latitude": "43.61",
        "Longitude": "-116.2",
        "Population": 975000,
    },
    "989": {
        "Metro Area": "Saginaw, MI",
        "Latitude": "43.42",
        "Longitude": "-83.95",
        "Population": 700000,
    },
}


def haversine_distance(point1, point2):
    # Earth radius in miles
    R = 3958.8
    lat1, lon1 = point1
    lat2, lon2 = point2

    phi1 = math.radians(lat1)
    phi2 = math.radians(lat2)

    delta_phi = math.radians(lat2 - lat1)
    delta_lambda = math.radians(lon2 - lon1)

    a = (
        math.sin(delta_phi / 2) ** 2
        + math.cos(phi1) * math.cos(phi2) * math.sin(delta_lambda / 2) ** 2
    )
    c = 2 * math.atan2(math.sqrt(a), math.sqrt(1 - a))

    distance = R * c
    return distance


def zip_to_area_code_distance(zip_code, area_code):
    zip_loc = nomi.query_postal_code(zip_code)
    zip_lat_lon = (float(zip_loc.latitude), float(zip_loc.longitude))

    area_code_info = AREA_CODES.get(area_code)
    if not area_code_info:
        warn(f"Area code {area_code} not found.")
        return None

    area_code_lat_lon = (
        float(area_code_info["Latitude"]),
        float(area_code_info["Longitude"]),
    )
    dist = haversine_distance(zip_lat_lon, area_code_lat_lon)
    rounded = round(dist, 1)
    return rounded if math.isfinite(rounded) else None


CRITERIA_AREA_CODES = {}


def init_criteria_area_codes():
    global CRITERIA_AREA_CODES

    info("Initializing criteria area codes")
    path = settings.CRITERIA_AREA_CODES_PATH

    try:
        with open(path, mode="r", encoding="utf-8") as csvfile:
            reader = csv.DictReader(csvfile)
            for row in reader:
                criteria_id = row.pop("criteria_id")
                try:
                    row["latitude"] = (
                        float(row["latitude"]) if row["latitude"] else None
                    )
                    row["longitude"] = (
                        float(row["longitude"]) if row["longitude"] else None
                    )
                    row["distance_miles"] = (
                        float(row["distance_miles"]) if row["distance_miles"] else None
                    )
                except (ValueError, TypeError) as e:
                    warn(
                        f"Could not convert numeric value for criteria_id {criteria_id}: {e}"
                    )
                CRITERIA_AREA_CODES[criteria_id] = row
        info(f"Loaded {len(CRITERIA_AREA_CODES)} criteria area codes from {path}")
    except FileNotFoundError:
        error(f"Criteria area codes file not found at {path}")
    except Exception as e:
        error(f"Error loading criteria area codes: {e}")
