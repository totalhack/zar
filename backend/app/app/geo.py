import math

import pgeocode
from tlbx import warn

nomi = pgeocode.Nominatim("us")

AREA_CODES = {
    "201": {
        "Metro Area": "Jersey City, NJ",
        "Latitude": "40.73",
        "Longitude": "-74.08",
    },
    "202": {"Metro Area": "Washington, DC", "Latitude": "38.90", "Longitude": "-77.04"},
    "203": {"Metro Area": "Bridgeport, CT", "Latitude": "41.18", "Longitude": "-73.19"},
    "205": {"Metro Area": "Birmingham, AL", "Latitude": "33.52", "Longitude": "-86.8"},
    "206": {"Metro Area": "Seattle, WA", "Latitude": "47.61", "Longitude": "-122.33"},
    "207": {"Metro Area": "Portland, ME", "Latitude": "43.66", "Longitude": "-70.25"},
    "208": {"Metro Area": "Boise, ID", "Latitude": "43.61", "Longitude": "-116.2"},
    "209": {"Metro Area": "Stockton, CA", "Latitude": "37.96", "Longitude": "-121.29"},
    "210": {
        "Metro Area": "San Antonio, TX",
        "Latitude": "29.42",
        "Longitude": "-98.49",
    },
    "212": {"Metro Area": "New York, NY", "Latitude": "40.71", "Longitude": "-74.01"},
    "213": {
        "Metro Area": "Los Angeles, CA",
        "Latitude": "34.05",
        "Longitude": "-118.24",
    },
    "214": {"Metro Area": "Dallas, TX", "Latitude": "32.78", "Longitude": "-96.8"},
    "215": {
        "Metro Area": "Philadelphia, PA",
        "Latitude": "39.95",
        "Longitude": "-75.16",
    },
    "216": {"Metro Area": "Cleveland, OH", "Latitude": "41.50", "Longitude": "-81.69"},
    "217": {
        "Metro Area": "Springfield, IL",
        "Latitude": "39.80",
        "Longitude": "-89.64",
    },
    "218": {"Metro Area": "Duluth, MN", "Latitude": "46.78", "Longitude": "-92.1"},
    "219": {"Metro Area": "Hammond, IN", "Latitude": "41.61", "Longitude": "-87.5"},
    "220": {"Metro Area": "Newark, OH", "Latitude": "40.06", "Longitude": "-82.4"},
    "223": {"Metro Area": "Lancaster, PA", "Latitude": "40.04", "Longitude": "-76.31"},
    "224": {"Metro Area": "Elgin, IL", "Latitude": "42.04", "Longitude": "-88.28"},
    "225": {
        "Metro Area": "Baton Rouge, LA",
        "Latitude": "30.45",
        "Longitude": "-91.19",
    },
    "227": {"Metro Area": "Germantown, MD", "Latitude": "39.17", "Longitude": "-77.27"},
    "228": {"Metro Area": "Gulfport, MS", "Latitude": "30.37", "Longitude": "-89.09"},
    "229": {"Metro Area": "Albany, GA", "Latitude": "31.58", "Longitude": "-84.16"},
    "231": {"Metro Area": "Muskegon, MI", "Latitude": "43.23", "Longitude": "-86.25"},
    "234": {"Metro Area": "Akron, OH", "Latitude": "41.08", "Longitude": "-81.52"},
    "235": {"Metro Area": "Columbia, MO", "Latitude": "38.95", "Longitude": "-92.33"},
    "239": {"Metro Area": "Cape Coral, FL", "Latitude": "26.66", "Longitude": "-81.95"},
    "240": {"Metro Area": "Germantown, MD", "Latitude": "39.17", "Longitude": "-77.27"},
    "248": {"Metro Area": "Troy, MI", "Latitude": "42.61", "Longitude": "-83.15"},
    "251": {"Metro Area": "Mobile, AL", "Latitude": "30.69", "Longitude": "-88.04"},
    "252": {"Metro Area": "Greenville, NC", "Latitude": "35.61", "Longitude": "-77.37"},
    "253": {"Metro Area": "Tacoma, WA", "Latitude": "47.25", "Longitude": "-122.44"},
    "254": {"Metro Area": "Killeen, TX", "Latitude": "31.12", "Longitude": "-97.73"},
    "256": {"Metro Area": "Huntsville, AL", "Latitude": "34.73", "Longitude": "-86.59"},
    "260": {"Metro Area": "Fort Wayne, IN", "Latitude": "41.08", "Longitude": "-85.14"},
    "262": {"Metro Area": "Kenosha, WI", "Latitude": "42.58", "Longitude": "-87.82"},
    "267": {
        "Metro Area": "Philadelphia, PA",
        "Latitude": "39.95",
        "Longitude": "-75.16",
    },
    "269": {"Metro Area": "Kalamazoo, MI", "Latitude": "42.29", "Longitude": "-85.59"},
    "270": {
        "Metro Area": "Bowling Green, KY",
        "Latitude": "36.99",
        "Longitude": "-86.44",
    },
    "272": {"Metro Area": "Scranton, PA", "Latitude": "41.41", "Longitude": "-75.66"},
    "274": {"Metro Area": "Green Bay, WI", "Latitude": "44.51", "Longitude": "-88.01"},
    "276": {"Metro Area": "Bristol, VA", "Latitude": "36.60", "Longitude": "-82.18"},
    "279": {
        "Metro Area": "Sacramento, CA",
        "Latitude": "38.58",
        "Longitude": "-121.49",
    },
    "281": {"Metro Area": "Houston, TX", "Latitude": "29.76", "Longitude": "-95.36"},
    "283": {"Metro Area": "Cincinnati, OH", "Latitude": "39.10", "Longitude": "-84.51"},
    "301": {"Metro Area": "Germantown, MD", "Latitude": "39.17", "Longitude": "-77.27"},
    "302": {"Metro Area": "Wilmington, DE", "Latitude": "39.74", "Longitude": "-75.55"},
    "303": {"Metro Area": "Denver, CO", "Latitude": "39.74", "Longitude": "-104.99"},
    "304": {"Metro Area": "Charleston, WV", "Latitude": "38.35", "Longitude": "-81.63"},
    "305": {"Metro Area": "Miami, FL", "Latitude": "25.76", "Longitude": "-80.19"},
    "307": {"Metro Area": "Cheyenne, WY", "Latitude": "41.14", "Longitude": "-104.82"},
    "308": {
        "Metro Area": "Grand Island, NE",
        "Latitude": "40.92",
        "Longitude": "-98.34",
    },
    "309": {"Metro Area": "Peoria, IL", "Latitude": "40.69", "Longitude": "-89.59"},
    "310": {
        "Metro Area": "Los Angeles, CA",
        "Latitude": "34.05",
        "Longitude": "-118.24",
    },
    "312": {"Metro Area": "Chicago, IL", "Latitude": "41.88", "Longitude": "-87.63"},
    "313": {"Metro Area": "Detroit, MI", "Latitude": "42.33", "Longitude": "-83.05"},
    "314": {"Metro Area": "St. Louis, MO", "Latitude": "38.63", "Longitude": "-90.2"},
    "315": {"Metro Area": "Syracuse, NY", "Latitude": "43.05", "Longitude": "-76.15"},
    "316": {"Metro Area": "Wichita, KS", "Latitude": "37.69", "Longitude": "-97.34"},
    "317": {
        "Metro Area": "Indianapolis, IN",
        "Latitude": "39.77",
        "Longitude": "-86.16",
    },
    "318": {"Metro Area": "Shreveport, LA", "Latitude": "32.53", "Longitude": "-93.75"},
    "319": {
        "Metro Area": "Cedar Rapids, IA",
        "Latitude": "42.00",
        "Longitude": "-91.67",
    },
    "320": {"Metro Area": "St. Cloud, MN", "Latitude": "45.55", "Longitude": "-94.16"},
    "321": {"Metro Area": "Orlando, FL", "Latitude": "28.54", "Longitude": "-81.38"},
    "323": {
        "Metro Area": "Los Angeles, CA",
        "Latitude": "34.05",
        "Longitude": "-118.24",
    },
    "324": {
        "Metro Area": "Jacksonville, FL",
        "Latitude": "30.33",
        "Longitude": "-81.66",
    },
    "325": {"Metro Area": "Abilene, TX", "Latitude": "32.45", "Longitude": "-99.73"},
    "326": {"Metro Area": "Dayton, OH", "Latitude": "39.76", "Longitude": "-84.19"},
    "327": {"Metro Area": "Jonesboro, AR", "Latitude": "35.84", "Longitude": "-90.7"},
    "329": {"Metro Area": "New City, NY", "Latitude": "41.15", "Longitude": "-73.99"},
    "330": {"Metro Area": "Akron, OH", "Latitude": "41.08", "Longitude": "-81.52"},
    "331": {"Metro Area": "Aurora, IL", "Latitude": "41.76", "Longitude": "-88.32"},
    "332": {"Metro Area": "New York, NY", "Latitude": "40.71", "Longitude": "-74.01"},
    "334": {"Metro Area": "Montgomery, AL", "Latitude": "32.38", "Longitude": "-86.3"},
    "336": {"Metro Area": "Greensboro, NC", "Latitude": "36.07", "Longitude": "-79.79"},
    "337": {"Metro Area": "Lafayette, LA", "Latitude": "30.22", "Longitude": "-92.02"},
    "339": {"Metro Area": "Boston, MA", "Latitude": "42.36", "Longitude": "-71.06"},
    "340": {
        "Metro Area": "Charlotte Amalie, VI",
        "Latitude": "18.34",
        "Longitude": "-64.93",
    },
    "341": {"Metro Area": "Oakland, CA", "Latitude": "37.80", "Longitude": "-122.27"},
    "343": {"Metro Area": "Ottawa, ON", "Latitude": "45.42", "Longitude": "-75.7"},
    "345": {"Metro Area": "Cayman Islands", "Latitude": "19.31", "Longitude": "-81.25"},
    "346": {"Metro Area": "Houston, TX", "Latitude": "29.76", "Longitude": "-95.36"},
    "347": {"Metro Area": "New York, NY", "Latitude": "40.71", "Longitude": "-74.01"},
    "350": {"Metro Area": "Stockton, CA", "Latitude": "37.96", "Longitude": "-121.29"},
    "351": {"Metro Area": "Lowell, MA", "Latitude": "42.63", "Longitude": "-71.32"},
    "352": {
        "Metro Area": "Gainesville, FL",
        "Latitude": "29.65",
        "Longitude": "-82.32",
    },
    "353": {"Metro Area": "Madison, WI", "Latitude": "43.07", "Longitude": "-89.4"},
    "354": {"Metro Area": "Granby, QC", "Latitude": "45.40", "Longitude": "-72.73"},
    "357": {"Metro Area": "Fresno, CA", "Latitude": "36.74", "Longitude": "-119.77"},
    "360": {"Metro Area": "Vancouver, WA", "Latitude": "45.64", "Longitude": "-122.66"},
    "361": {
        "Metro Area": "Corpus Christi, TX",
        "Latitude": "27.80",
        "Longitude": "-97.4",
    },
    "362": {"Metro Area": "Hempstead, NY", "Latitude": "40.71", "Longitude": "-73.62"},
    "363": {"Metro Area": "Hempstead, NY", "Latitude": "40.71", "Longitude": "-73.62"},
    "364": {
        "Metro Area": "Bowling Green, KY",
        "Latitude": "36.99",
        "Longitude": "-86.44",
    },
    "365": {"Metro Area": "Hamilton, ON", "Latitude": "43.26", "Longitude": "-79.87"},
    "367": {"Metro Area": "Quebec, QC", "Latitude": "46.81", "Longitude": "-71.21"},
    "368": {"Metro Area": "Calgary, AB", "Latitude": "51.05", "Longitude": "-114.07"},
    "369": {
        "Metro Area": "Santa Rosa, CA",
        "Latitude": "38.44",
        "Longitude": "-122.71",
    },
    "380": {"Metro Area": "Columbus, OH", "Latitude": "39.96", "Longitude": "-83.0"},
    "382": {"Metro Area": "London, ON", "Latitude": "42.98", "Longitude": "-81.24"},
    "385": {
        "Metro Area": "Salt Lake City, UT",
        "Latitude": "40.76",
        "Longitude": "-111.89",
    },
    "386": {"Metro Area": "Palm Coast, FL", "Latitude": "29.54", "Longitude": "-81.24"},
    "401": {"Metro Area": "Providence, RI", "Latitude": "41.82", "Longitude": "-71.41"},
    "402": {"Metro Area": "Omaha, NE", "Latitude": "41.25", "Longitude": "-95.94"},
    "404": {"Metro Area": "Atlanta, GA", "Latitude": "33.75", "Longitude": "-84.39"},
    "405": {
        "Metro Area": "Oklahoma City, OK",
        "Latitude": "35.47",
        "Longitude": "-97.52",
    },
    "406": {"Metro Area": "Billings, MT", "Latitude": "45.78", "Longitude": "-108.5"},
    "407": {"Metro Area": "Orlando, FL", "Latitude": "28.54", "Longitude": "-81.38"},
    "408": {"Metro Area": "San Jose, CA", "Latitude": "37.34", "Longitude": "-121.89"},
    "409": {"Metro Area": "Beaumont, TX", "Latitude": "30.08", "Longitude": "-94.13"},
    "410": {"Metro Area": "Baltimore, MD", "Latitude": "39.29", "Longitude": "-76.61"},
    "412": {"Metro Area": "Pittsburgh, PA", "Latitude": "40.44", "Longitude": "-79.99"},
    "413": {
        "Metro Area": "Springfield, MA",
        "Latitude": "42.10",
        "Longitude": "-72.59",
    },
    "414": {"Metro Area": "Milwaukee, WI", "Latitude": "43.04", "Longitude": "-87.91"},
    "415": {
        "Metro Area": "San Francisco, CA",
        "Latitude": "37.77",
        "Longitude": "-122.42",
    },
    "416": {"Metro Area": "Toronto, ON", "Latitude": "43.65", "Longitude": "-79.38"},
    "417": {"Metro Area": "Springfield, MO", "Latitude": "37.21", "Longitude": "-93.3"},
    "419": {"Metro Area": "Toledo, OH", "Latitude": "41.66", "Longitude": "-83.54"},
    "423": {
        "Metro Area": "Chattanooga, TN",
        "Latitude": "35.05",
        "Longitude": "-85.31",
    },
    "424": {
        "Metro Area": "Los Angeles, CA",
        "Latitude": "34.05",
        "Longitude": "-118.24",
    },
    "425": {"Metro Area": "Bellevue, WA", "Latitude": "47.61", "Longitude": "-122.2"},
    "430": {"Metro Area": "Tyler, TX", "Latitude": "32.35", "Longitude": "-95.3"},
    "432": {"Metro Area": "Midland, TX", "Latitude": "32.00", "Longitude": "-102.08"},
    "434": {"Metro Area": "Lynchburg, VA", "Latitude": "37.41", "Longitude": "-79.14"},
    "435": {
        "Metro Area": "St. George, UT",
        "Latitude": "37.10",
        "Longitude": "-113.58",
    },
    "436": {"Metro Area": "Parma, OH", "Latitude": "41.41", "Longitude": "-81.73"},
    "437": {"Metro Area": "Toronto, ON", "Latitude": "43.65", "Longitude": "-79.38"},
    "440": {"Metro Area": "Parma, OH", "Latitude": "41.41", "Longitude": "-81.73"},
    "442": {"Metro Area": "Oceanside, CA", "Latitude": "33.19", "Longitude": "-117.38"},
    "443": {"Metro Area": "Baltimore, MD", "Latitude": "39.29", "Longitude": "-76.61"},
    "445": {
        "Metro Area": "Philadelphia, PA",
        "Latitude": "39.95",
        "Longitude": "-75.16",
    },
    "447": {
        "Metro Area": "Springfield, IL",
        "Latitude": "39.80",
        "Longitude": "-89.64",
    },
    "448": {
        "Metro Area": "Tallahassee, FL",
        "Latitude": "30.44",
        "Longitude": "-84.28",
    },
    "457": {"Metro Area": "Shreveport, LA", "Latitude": "32.53", "Longitude": "-93.75"},
    "458": {"Metro Area": "Eugene, OR", "Latitude": "44.05", "Longitude": "-123.09"},
    "463": {
        "Metro Area": "Indianapolis, IN",
        "Latitude": "39.77",
        "Longitude": "-86.16",
    },
    "464": {"Metro Area": "Cicero, IL", "Latitude": "41.85", "Longitude": "-87.75"},
    "469": {"Metro Area": "Dallas, TX", "Latitude": "32.78", "Longitude": "-96.8"},
    "470": {"Metro Area": "Atlanta, GA", "Latitude": "33.75", "Longitude": "-84.39"},
    "472": {
        "Metro Area": "Fayetteville, NC",
        "Latitude": "35.05",
        "Longitude": "-78.88",
    },
    "473": {"Metro Area": "Grenada", "Latitude": "12.11", "Longitude": "-61.68"},
    "475": {"Metro Area": "Bridgeport, CT", "Latitude": "41.18", "Longitude": "-73.19"},
    "478": {"Metro Area": "Macon, GA", "Latitude": "32.84", "Longitude": "-83.63"},
    "479": {"Metro Area": "Fort Smith, AR", "Latitude": "35.39", "Longitude": "-94.42"},
    "480": {"Metro Area": "Phoenix, AZ", "Latitude": "33.45", "Longitude": "-112.07"},
    "483": {"Metro Area": "Montgomery, AL", "Latitude": "32.38", "Longitude": "-86.3"},
    "484": {"Metro Area": "Allentown, PA", "Latitude": "40.61", "Longitude": "-75.49"},
    "501": {
        "Metro Area": "Little Rock, AR",
        "Latitude": "34.75",
        "Longitude": "-92.29",
    },
    "502": {"Metro Area": "Louisville, KY", "Latitude": "38.25", "Longitude": "-85.76"},
    "503": {"Metro Area": "Portland, OR", "Latitude": "45.52", "Longitude": "-122.68"},
    "504": {
        "Metro Area": "New Orleans, LA",
        "Latitude": "29.95",
        "Longitude": "-90.07",
    },
    "505": {
        "Metro Area": "Albuquerque, NM",
        "Latitude": "35.08",
        "Longitude": "-106.65",
    },
    "507": {"Metro Area": "Rochester, MN", "Latitude": "44.02", "Longitude": "-92.46"},
    "508": {"Metro Area": "Worcester, MA", "Latitude": "42.26", "Longitude": "-71.8"},
    "509": {"Metro Area": "Spokane, WA", "Latitude": "47.66", "Longitude": "-117.43"},
    "510": {"Metro Area": "Oakland, CA", "Latitude": "37.80", "Longitude": "-122.27"},
    "512": {"Metro Area": "Austin, TX", "Latitude": "30.27", "Longitude": "-97.74"},
    "513": {"Metro Area": "Cincinnati, OH", "Latitude": "39.10", "Longitude": "-84.51"},
    "515": {"Metro Area": "Des Moines, IA", "Latitude": "41.59", "Longitude": "-93.61"},
    "516": {"Metro Area": "Hempstead, NY", "Latitude": "40.71", "Longitude": "-73.62"},
    "517": {"Metro Area": "Lansing, MI", "Latitude": "42.73", "Longitude": "-84.56"},
    "518": {"Metro Area": "Albany, NY", "Latitude": "42.65", "Longitude": "-73.76"},
    "520": {"Metro Area": "Tucson, AZ", "Latitude": "32.22", "Longitude": "-110.97"},
    "530": {"Metro Area": "Redding, CA", "Latitude": "40.59", "Longitude": "-122.39"},
    "531": {"Metro Area": "Omaha, NE", "Latitude": "41.25", "Longitude": "-95.94"},
    "534": {"Metro Area": "Eau Claire, WI", "Latitude": "44.81", "Longitude": "-91.5"},
    "539": {"Metro Area": "Tulsa, OK", "Latitude": "36.15", "Longitude": "-95.99"},
    "540": {"Metro Area": "Roanoke, VA", "Latitude": "37.27", "Longitude": "-79.94"},
    "541": {"Metro Area": "Eugene, OR", "Latitude": "44.05", "Longitude": "-123.09"},
    "548": {"Metro Area": "London, ON", "Latitude": "42.98", "Longitude": "-81.24"},
    "551": {
        "Metro Area": "Jersey City, NJ",
        "Latitude": "40.73",
        "Longitude": "-74.08",
    },
    "557": {"Metro Area": "St. Louis, MO", "Latitude": "38.63", "Longitude": "-90.2"},
    "559": {"Metro Area": "Fresno, CA", "Latitude": "36.74", "Longitude": "-119.77"},
    "561": {
        "Metro Area": "West Palm Beach, FL",
        "Latitude": "26.71",
        "Longitude": "-80.05",
    },
    "562": {
        "Metro Area": "Long Beach, CA",
        "Latitude": "33.77",
        "Longitude": "-118.19",
    },
    "563": {"Metro Area": "Davenport, IA", "Latitude": "41.52", "Longitude": "-90.58"},
    "564": {"Metro Area": "Seattle, WA", "Latitude": "47.61", "Longitude": "-122.33"},
    "567": {"Metro Area": "Toledo, OH", "Latitude": "41.66", "Longitude": "-83.54"},
    "570": {"Metro Area": "Scranton, PA", "Latitude": "41.41", "Longitude": "-75.66"},
    "571": {"Metro Area": "Arlington, VA", "Latitude": "38.88", "Longitude": "-77.1"},
    "572": {
        "Metro Area": "Oklahoma City, OK",
        "Latitude": "35.47",
        "Longitude": "-97.52",
    },
    "573": {"Metro Area": "Columbia, MO", "Latitude": "38.95", "Longitude": "-92.33"},
    "574": {"Metro Area": "South Bend, IN", "Latitude": "41.68", "Longitude": "-86.25"},
    "575": {
        "Metro Area": "Las Cruces, NM",
        "Latitude": "32.31",
        "Longitude": "-106.78",
    },
    "580": {"Metro Area": "Lawton, OK", "Latitude": "34.61", "Longitude": "-98.39"},
    "581": {"Metro Area": "Quebec, QC", "Latitude": "46.81", "Longitude": "-71.21"},
    "582": {"Metro Area": "Erie, PA", "Latitude": "42.13", "Longitude": "-80.09"},
    "585": {"Metro Area": "Rochester, NY", "Latitude": "43.15", "Longitude": "-77.61"},
    "586": {"Metro Area": "Warren, MI", "Latitude": "42.49", "Longitude": "-83.03"},
    "601": {"Metro Area": "Jackson, MS", "Latitude": "32.30", "Longitude": "-90.18"},
    "602": {"Metro Area": "Phoenix, AZ", "Latitude": "33.45", "Longitude": "-112.07"},
    "603": {"Metro Area": "Manchester, NH", "Latitude": "42.99", "Longitude": "-71.46"},
    "605": {
        "Metro Area": "Sioux Falls, SD",
        "Latitude": "43.55",
        "Longitude": "-96.73",
    },
    "606": {"Metro Area": "Ashland, KY", "Latitude": "38.47", "Longitude": "-82.64"},
    "607": {"Metro Area": "Binghamton, NY", "Latitude": "42.10", "Longitude": "-75.91"},
    "608": {"Metro Area": "Madison, WI", "Latitude": "43.07", "Longitude": "-89.4"},
    "609": {"Metro Area": "Trenton, NJ", "Latitude": "40.22", "Longitude": "-74.76"},
    "610": {"Metro Area": "Allentown, PA", "Latitude": "40.61", "Longitude": "-75.49"},
    "612": {
        "Metro Area": "Minneapolis, MN",
        "Latitude": "44.98",
        "Longitude": "-93.26",
    },
    "614": {"Metro Area": "Columbus, OH", "Latitude": "39.96", "Longitude": "-83.0"},
    "615": {"Metro Area": "Nashville, TN", "Latitude": "36.16", "Longitude": "-86.78"},
    "616": {
        "Metro Area": "Grand Rapids, MI",
        "Latitude": "42.96",
        "Longitude": "-85.67",
    },
    "617": {"Metro Area": "Boston, MA", "Latitude": "42.36", "Longitude": "-71.06"},
    "618": {"Metro Area": "Belleville, IL", "Latitude": "38.52", "Longitude": "-89.98"},
    "619": {"Metro Area": "San Diego, CA", "Latitude": "32.72", "Longitude": "-117.16"},
    "620": {"Metro Area": "Hutchinson, KS", "Latitude": "38.06", "Longitude": "-97.93"},
    "621": {"Metro Area": "Houston, TX", "Latitude": "29.76", "Longitude": "-95.36"},
    "623": {"Metro Area": "Phoenix, AZ", "Latitude": "33.45", "Longitude": "-112.07"},
    "624": {"Metro Area": "Buffalo, NY", "Latitude": "42.89", "Longitude": "-78.88"},
    "626": {"Metro Area": "Pasadena, CA", "Latitude": "34.15", "Longitude": "-118.14"},
    "628": {
        "Metro Area": "San Francisco, CA",
        "Latitude": "37.77",
        "Longitude": "-122.42",
    },
    "629": {"Metro Area": "Nashville, TN", "Latitude": "36.16", "Longitude": "-86.78"},
    "630": {"Metro Area": "Aurora, IL", "Latitude": "41.76", "Longitude": "-88.32"},
    "631": {"Metro Area": "Brentwood, NY", "Latitude": "40.78", "Longitude": "-73.24"},
    "636": {"Metro Area": "O'Fallon, MO", "Latitude": "38.81", "Longitude": "-90.7"},
    "640": {"Metro Area": "Trenton, NJ", "Latitude": "40.22", "Longitude": "-74.76"},
    "641": {"Metro Area": "Mason City, IA", "Latitude": "43.15", "Longitude": "-93.2"},
    "645": {"Metro Area": "Miami, FL", "Latitude": "25.76", "Longitude": "-80.19"},
    "646": {"Metro Area": "New York, NY", "Latitude": "40.71", "Longitude": "-74.01"},
    "647": {"Metro Area": "Toronto, ON", "Latitude": "43.65", "Longitude": "-79.38"},
    "650": {"Metro Area": "San Mateo, CA", "Latitude": "37.56", "Longitude": "-122.31"},
    "651": {"Metro Area": "St. Paul, MN", "Latitude": "44.95", "Longitude": "-93.09"},
    "656": {"Metro Area": "Tampa, FL", "Latitude": "27.95", "Longitude": "-82.46"},
    "657": {"Metro Area": "Anaheim, CA", "Latitude": "33.84", "Longitude": "-117.91"},
    "659": {"Metro Area": "Birmingham, AL", "Latitude": "33.52", "Longitude": "-86.8"},
    "660": {"Metro Area": "Sedalia, MO", "Latitude": "38.70", "Longitude": "-93.23"},
    "661": {
        "Metro Area": "Bakersfield, CA",
        "Latitude": "35.37",
        "Longitude": "-119.02",
    },
    "662": {"Metro Area": "Southaven, MS", "Latitude": "34.99", "Longitude": "-90.0"},
    "667": {"Metro Area": "Baltimore, MD", "Latitude": "39.29", "Longitude": "-76.61"},
    "669": {"Metro Area": "San Jose, CA", "Latitude": "37.34", "Longitude": "-121.89"},
    "670": {"Metro Area": "Saipan, MP", "Latitude": "15.18", "Longitude": "-145.75"},
    "671": {"Metro Area": "Dededo, GU", "Latitude": "13.52", "Longitude": "-144.84"},
    "678": {"Metro Area": "Atlanta, GA", "Latitude": "33.75", "Longitude": "-84.39"},
    "679": {"Metro Area": "Detroit, MI", "Latitude": "42.33", "Longitude": "-83.05"},
    "680": {"Metro Area": "Syracuse, NY", "Latitude": "43.05", "Longitude": "-76.15"},
    "681": {"Metro Area": "Charleston, WV", "Latitude": "38.35", "Longitude": "-81.63"},
    "682": {"Metro Area": "Fort Worth, TX", "Latitude": "32.75", "Longitude": "-97.33"},
    "684": {"Metro Area": "Pago Pago, AS", "Latitude": "14.28", "Longitude": "-170.7"},
    "686": {"Metro Area": "Richmond, VA", "Latitude": "37.54", "Longitude": "-77.43"},
    "689": {"Metro Area": "Orlando, FL", "Latitude": "28.54", "Longitude": "-81.38"},
    "701": {"Metro Area": "Fargo, ND", "Latitude": "46.88", "Longitude": "-96.79"},
    "702": {"Metro Area": "Las Vegas, NV", "Latitude": "36.17", "Longitude": "-115.14"},
    "703": {"Metro Area": "Arlington, VA", "Latitude": "38.88", "Longitude": "-77.1"},
    "704": {"Metro Area": "Charlotte, NC", "Latitude": "35.23", "Longitude": "-80.84"},
    "706": {"Metro Area": "Augusta, GA", "Latitude": "33.47", "Longitude": "-81.97"},
    "707": {
        "Metro Area": "Santa Rosa, CA",
        "Latitude": "38.44",
        "Longitude": "-122.71",
    },
    "708": {"Metro Area": "Cicero, IL", "Latitude": "41.85", "Longitude": "-87.75"},
    "712": {"Metro Area": "Sioux City, IA", "Latitude": "42.50", "Longitude": "-96.4"},
    "713": {"Metro Area": "Houston, TX", "Latitude": "29.76", "Longitude": "-95.36"},
    "714": {"Metro Area": "Anaheim, CA", "Latitude": "33.84", "Longitude": "-117.91"},
    "715": {"Metro Area": "Eau Claire, WI", "Latitude": "44.81", "Longitude": "-91.5"},
    "716": {"Metro Area": "Buffalo, NY", "Latitude": "42.89", "Longitude": "-78.88"},
    "717": {"Metro Area": "Lancaster, PA", "Latitude": "40.04", "Longitude": "-76.31"},
    "718": {"Metro Area": "New York, NY", "Latitude": "40.71", "Longitude": "-74.01"},
    "719": {
        "Metro Area": "Colorado Springs, CO",
        "Latitude": "38.83",
        "Longitude": "-104.82",
    },
    "720": {"Metro Area": "Denver, CO", "Latitude": "39.74", "Longitude": "-104.99"},
    "724": {"Metro Area": "New Castle, PA", "Latitude": "41.00", "Longitude": "-80.35"},
    "725": {"Metro Area": "Las Vegas, NV", "Latitude": "36.17", "Longitude": "-115.14"},
    "726": {
        "Metro Area": "San Antonio, TX",
        "Latitude": "29.42",
        "Longitude": "-98.49",
    },
    "727": {
        "Metro Area": "St. Petersburg, FL",
        "Latitude": "27.76",
        "Longitude": "-82.64",
    },
    "728": {
        "Metro Area": "West Palm Beach, FL",
        "Latitude": "26.71",
        "Longitude": "-80.05",
    },
    "729": {
        "Metro Area": "Chattanooga, TN",
        "Latitude": "35.05",
        "Longitude": "-85.31",
    },
    "730": {"Metro Area": "Belleville, IL", "Latitude": "38.52", "Longitude": "-89.98"},
    "731": {"Metro Area": "Jackson, TN", "Latitude": "35.61", "Longitude": "-88.82"},
    "732": {"Metro Area": "Toms River, NJ", "Latitude": "39.96", "Longitude": "-74.2"},
    "734": {"Metro Area": "Ann Arbor, MI", "Latitude": "42.28", "Longitude": "-83.74"},
    "737": {"Metro Area": "Austin, TX", "Latitude": "30.27", "Longitude": "-97.74"},
    "738": {
        "Metro Area": "Los Angeles, CA",
        "Latitude": "34.05",
        "Longitude": "-118.24",
    },
    "740": {"Metro Area": "Newark, OH", "Latitude": "40.06", "Longitude": "-82.4"},
    "743": {"Metro Area": "Greensboro, NC", "Latitude": "36.07", "Longitude": "-79.79"},
    "747": {
        "Metro Area": "Los Angeles, CA",
        "Latitude": "34.05",
        "Longitude": "-118.24",
    },
    "748": {
        "Metro Area": "Fort Collins, CO",
        "Latitude": "40.59",
        "Longitude": "-105.08",
    },
    "754": {
        "Metro Area": "Fort Lauderdale, FL",
        "Latitude": "26.12",
        "Longitude": "-80.14",
    },
    "757": {
        "Metro Area": "Virginia Beach, VA",
        "Latitude": "36.85",
        "Longitude": "-75.98",
    },
    "760": {"Metro Area": "Oceanside, CA", "Latitude": "33.19", "Longitude": "-117.38"},
    "762": {"Metro Area": "Augusta, GA", "Latitude": "33.47", "Longitude": "-81.97"},
    "763": {
        "Metro Area": "Brooklyn Park, MN",
        "Latitude": "45.09",
        "Longitude": "-93.36",
    },
    "765": {"Metro Area": "Muncie, IN", "Latitude": "40.19", "Longitude": "-85.39"},
    "769": {"Metro Area": "Jackson, MS", "Latitude": "32.30", "Longitude": "-90.18"},
    "770": {"Metro Area": "Roswell, GA", "Latitude": "34.02", "Longitude": "-84.36"},
    "771": {"Metro Area": "Washington, DC", "Latitude": "38.90", "Longitude": "-77.04"},
    "772": {
        "Metro Area": "Port St. Lucie, FL",
        "Latitude": "27.29",
        "Longitude": "-80.35",
    },
    "773": {"Metro Area": "Chicago, IL", "Latitude": "41.88", "Longitude": "-87.63"},
    "774": {"Metro Area": "Worcester, MA", "Latitude": "42.26", "Longitude": "-71.8"},
    "775": {"Metro Area": "Reno, NV", "Latitude": "39.53", "Longitude": "-119.81"},
    "779": {"Metro Area": "Rockford, IL", "Latitude": "42.27", "Longitude": "-89.09"},
    "780": {"Metro Area": "Edmonton, AB", "Latitude": "53.54", "Longitude": "-113.49"},
    "781": {"Metro Area": "Boston, MA", "Latitude": "42.36", "Longitude": "-71.06"},
    "785": {"Metro Area": "Topeka, KS", "Latitude": "39.05", "Longitude": "-95.68"},
    "786": {"Metro Area": "Miami, FL", "Latitude": "25.76", "Longitude": "-80.19"},
    "787": {"Metro Area": "San Juan, PR", "Latitude": "18.47", "Longitude": "-66.12"},
    "801": {
        "Metro Area": "Salt Lake City, UT",
        "Latitude": "40.76",
        "Longitude": "-111.89",
    },
    "802": {"Metro Area": "Burlington, VT", "Latitude": "44.48", "Longitude": "-73.21"},
    "803": {"Metro Area": "Columbia, SC", "Latitude": "34.00", "Longitude": "-81.03"},
    "804": {"Metro Area": "Richmond, VA", "Latitude": "37.54", "Longitude": "-77.43"},
    "805": {"Metro Area": "Oxnard, CA", "Latitude": "34.20", "Longitude": "-119.18"},
    "806": {"Metro Area": "Lubbock, TX", "Latitude": "33.58", "Longitude": "-101.86"},
    "808": {"Metro Area": "Honolulu, HI", "Latitude": "21.31", "Longitude": "-157.86"},
    "810": {"Metro Area": "Flint, MI", "Latitude": "43.01", "Longitude": "-83.69"},
    "812": {"Metro Area": "Evansville, IN", "Latitude": "37.97", "Longitude": "-87.56"},
    "813": {"Metro Area": "Tampa, FL", "Latitude": "27.95", "Longitude": "-82.46"},
    "814": {"Metro Area": "Erie, PA", "Latitude": "42.13", "Longitude": "-80.09"},
    "815": {"Metro Area": "Rockford, IL", "Latitude": "42.27", "Longitude": "-89.09"},
    "816": {
        "Metro Area": "Kansas City, MO",
        "Latitude": "39.10",
        "Longitude": "-94.58",
    },
    "817": {"Metro Area": "Fort Worth, TX", "Latitude": "32.75", "Longitude": "-97.33"},
    "818": {
        "Metro Area": "Los Angeles, CA",
        "Latitude": "34.05",
        "Longitude": "-118.24",
    },
    "820": {"Metro Area": "Oxnard, CA", "Latitude": "34.20", "Longitude": "-119.18"},
    "821": {"Metro Area": "Greenville, SC", "Latitude": "34.85", "Longitude": "-82.4"},
    "825": {"Metro Area": "Calgary, AB", "Latitude": "51.05", "Longitude": "-114.07"},
    "826": {"Metro Area": "Roanoke, VA", "Latitude": "37.27", "Longitude": "-79.94"},
    "828": {"Metro Area": "Asheville, NC", "Latitude": "35.60", "Longitude": "-82.55"},
    "830": {
        "Metro Area": "New Braunfels, TX",
        "Latitude": "29.70",
        "Longitude": "-98.12",
    },
    "831": {"Metro Area": "Salinas, CA", "Latitude": "36.68", "Longitude": "-121.66"},
    "832": {"Metro Area": "Houston, TX", "Latitude": "29.76", "Longitude": "-95.36"},
    "835": {"Metro Area": "Allentown, PA", "Latitude": "40.61", "Longitude": "-75.49"},
    "837": {"Metro Area": "Redding, CA", "Latitude": "40.59", "Longitude": "-122.39"},
    "838": {"Metro Area": "Albany, NY", "Latitude": "42.65", "Longitude": "-73.76"},
    "839": {"Metro Area": "Columbia, SC", "Latitude": "34.00", "Longitude": "-81.03"},
    "840": {
        "Metro Area": "San Bernardino, CA",
        "Latitude": "34.11",
        "Longitude": "-117.29",
    },
    "843": {"Metro Area": "Charleston, SC", "Latitude": "32.78", "Longitude": "-79.93"},
    "845": {"Metro Area": "New City, NY", "Latitude": "41.15", "Longitude": "-73.99"},
    "847": {"Metro Area": "Elgin, IL", "Latitude": "42.04", "Longitude": "-88.28"},
    "848": {"Metro Area": "Toms River, NJ", "Latitude": "39.96", "Longitude": "-74.2"},
    "850": {
        "Metro Area": "Tallahassee, FL",
        "Latitude": "30.44",
        "Longitude": "-84.28",
    },
    "854": {"Metro Area": "Charleston, SC", "Latitude": "32.78", "Longitude": "-79.93"},
    "856": {"Metro Area": "Camden, NJ", "Latitude": "39.93", "Longitude": "-75.12"},
    "857": {"Metro Area": "Boston, MA", "Latitude": "42.36", "Longitude": "-71.06"},
    "858": {"Metro Area": "San Diego, CA", "Latitude": "32.72", "Longitude": "-117.16"},
    "859": {"Metro Area": "Lexington, KY", "Latitude": "38.05", "Longitude": "-84.5"},
    "860": {"Metro Area": "Hartford, CT", "Latitude": "41.76", "Longitude": "-72.69"},
    "862": {"Metro Area": "Newark, NJ", "Latitude": "40.74", "Longitude": "-74.17"},
    "863": {"Metro Area": "Lakeland, FL", "Latitude": "28.04", "Longitude": "-81.95"},
    "864": {"Metro Area": "Greenville, SC", "Latitude": "34.85", "Longitude": "-82.4"},
    "865": {"Metro Area": "Knoxville, TN", "Latitude": "35.96", "Longitude": "-83.92"},
    "870": {"Metro Area": "Jonesboro, AR", "Latitude": "35.84", "Longitude": "-90.7"},
    "872": {"Metro Area": "Chicago, IL", "Latitude": "41.88", "Longitude": "-87.63"},
    "878": {"Metro Area": "Pittsburgh, PA", "Latitude": "40.44", "Longitude": "-79.99"},
    "901": {"Metro Area": "Memphis, TN", "Latitude": "35.15", "Longitude": "-90.05"},
    "903": {"Metro Area": "Tyler, TX", "Latitude": "32.35", "Longitude": "-95.3"},
    "904": {
        "Metro Area": "Jacksonville, FL",
        "Latitude": "30.33",
        "Longitude": "-81.66",
    },
    "906": {"Metro Area": "Marquette, MI", "Latitude": "46.54", "Longitude": "-87.4"},
    "907": {"Metro Area": "Anchorage, AK", "Latitude": "61.22", "Longitude": "-149.9"},
    "908": {"Metro Area": "Elizabeth, NJ", "Latitude": "40.66", "Longitude": "-74.21"},
    "909": {
        "Metro Area": "San Bernardino, CA",
        "Latitude": "34.11",
        "Longitude": "-117.29",
    },
    "910": {
        "Metro Area": "Fayetteville, NC",
        "Latitude": "35.05",
        "Longitude": "-78.88",
    },
    "912": {"Metro Area": "Savannah, GA", "Latitude": "32.08", "Longitude": "-81.09"},
    "913": {
        "Metro Area": "Overland Park, KS",
        "Latitude": "38.98",
        "Longitude": "-94.67",
    },
    "914": {"Metro Area": "Yonkers, NY", "Latitude": "40.93", "Longitude": "-73.89"},
    "915": {"Metro Area": "El Paso, TX", "Latitude": "31.76", "Longitude": "-106.49"},
    "916": {
        "Metro Area": "Sacramento, CA",
        "Latitude": "38.58",
        "Longitude": "-121.49",
    },
    "917": {"Metro Area": "New York, NY", "Latitude": "40.71", "Longitude": "-74.01"},
    "918": {"Metro Area": "Tulsa, OK", "Latitude": "36.15", "Longitude": "-95.99"},
    "919": {"Metro Area": "Raleigh, NC", "Latitude": "35.77", "Longitude": "-78.64"},
    "920": {"Metro Area": "Green Bay, WI", "Latitude": "44.51", "Longitude": "-88.01"},
    "925": {"Metro Area": "Concord, CA", "Latitude": "37.98", "Longitude": "-122.03"},
    "928": {"Metro Area": "Yuma, AZ", "Latitude": "32.73", "Longitude": "-114.62"},
    "929": {"Metro Area": "New York, NY", "Latitude": "40.71", "Longitude": "-74.01"},
    "930": {"Metro Area": "Evansville, IN", "Latitude": "37.97", "Longitude": "-87.56"},
    "931": {
        "Metro Area": "Clarksville, TN",
        "Latitude": "36.53",
        "Longitude": "-87.36",
    },
    "934": {"Metro Area": "Brentwood, NY", "Latitude": "40.78", "Longitude": "-73.24"},
    "936": {"Metro Area": "Conroe, TX", "Latitude": "30.31", "Longitude": "-95.46"},
    "937": {"Metro Area": "Dayton, OH", "Latitude": "39.76", "Longitude": "-84.19"},
    "938": {"Metro Area": "Huntsville, AL", "Latitude": "34.73", "Longitude": "-86.59"},
    "939": {"Metro Area": "San Juan, PR", "Latitude": "18.47", "Longitude": "-66.12"},
    "940": {"Metro Area": "Denton, TX", "Latitude": "33.21", "Longitude": "-97.13"},
    "941": {"Metro Area": "North Port, FL", "Latitude": "27.04", "Longitude": "-82.23"},
    "943": {"Metro Area": "Atlanta, GA", "Latitude": "33.75", "Longitude": "-84.39"},
    "945": {"Metro Area": "Dallas, TX", "Latitude": "32.78", "Longitude": "-96.8"},
    "947": {"Metro Area": "Troy, MI", "Latitude": "42.61", "Longitude": "-83.15"},
    "948": {
        "Metro Area": "Virginia Beach, VA",
        "Latitude": "36.85",
        "Longitude": "-75.98",
    },
    "949": {"Metro Area": "Irvine, CA", "Latitude": "33.68", "Longitude": "-117.83"},
    "951": {"Metro Area": "Riverside, CA", "Latitude": "33.95", "Longitude": "-117.39"},
    "952": {
        "Metro Area": "Bloomington, MN",
        "Latitude": "44.84",
        "Longitude": "-93.29",
    },
    "954": {
        "Metro Area": "Fort Lauderdale, FL",
        "Latitude": "26.12",
        "Longitude": "-80.14",
    },
    "956": {"Metro Area": "Laredo, TX", "Latitude": "27.53", "Longitude": "-99.48"},
    "959": {"Metro Area": "Hartford, CT", "Latitude": "41.76", "Longitude": "-72.69"},
    "970": {
        "Metro Area": "Fort Collins, CO",
        "Latitude": "40.59",
        "Longitude": "-105.08",
    },
    "971": {"Metro Area": "Portland, OR", "Latitude": "45.52", "Longitude": "-122.68"},
    "972": {"Metro Area": "Dallas, TX", "Latitude": "32.78", "Longitude": "-96.8"},
    "973": {"Metro Area": "Newark, NJ", "Latitude": "40.74", "Longitude": "-74.17"},
    "975": {
        "Metro Area": "Kansas City, MO",
        "Latitude": "39.10",
        "Longitude": "-94.58",
    },
    "978": {"Metro Area": "Lowell, MA", "Latitude": "42.63", "Longitude": "-71.32"},
    "979": {
        "Metro Area": "College Station, TX",
        "Latitude": "30.63",
        "Longitude": "-96.33",
    },
    "980": {"Metro Area": "Charlotte, NC", "Latitude": "35.23", "Longitude": "-80.84"},
    "983": {"Metro Area": "Denver, CO", "Latitude": "39.74", "Longitude": "-104.99"},
    "984": {"Metro Area": "Raleigh, NC", "Latitude": "35.77", "Longitude": "-78.64"},
    "985": {"Metro Area": "Houma, LA", "Latitude": "29.60", "Longitude": "-90.72"},
    "986": {"Metro Area": "Boise, ID", "Latitude": "43.61", "Longitude": "-116.2"},
    "989": {"Metro Area": "Saginaw, MI", "Latitude": "43.42", "Longitude": "-83.95"},
}


def haversine_distance(point1, point2):
    # Earth radius in miles
    R = 3958.8
    lat1, lon1 = point1
    lat2, lon2 = point2

    phi1 = math.radians(lat1)
    phi2 = math.radians(lat2)

    delta_phi = math.radians(lat2 - lat1)
    delta_lambda = math.radians(lon2 - lon1)

    a = (
        math.sin(delta_phi / 2) ** 2
        + math.cos(phi1) * math.cos(phi2) * math.sin(delta_lambda / 2) ** 2
    )
    c = 2 * math.atan2(math.sqrt(a), math.sqrt(1 - a))

    distance = R * c
    return distance


def zip_to_area_code_distance(zip_code, area_code):
    zip_loc = nomi.query_postal_code(zip_code)
    zip_lat_lon = (float(zip_loc.latitude), float(zip_loc.longitude))

    area_code_info = AREA_CODES.get(area_code)
    if not area_code_info:
        warn(f"Area code {area_code} not found.")
        return None

    area_code_lat_lon = (
        float(area_code_info["Latitude"]),
        float(area_code_info["Longitude"]),
    )
    dist = haversine_distance(zip_lat_lon, area_code_lat_lon)
    return round(dist, 1)
